define(["jimu-core","jimu-ui","jimu-layouts/layout-runtime"],(function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=329)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},15:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),o=n(53),a=i.React.useState,l=i.React.useEffect,u=i.React.useMemo,c=i.React.useRef,s=i.ReactRedux.useSelector,d=n(2),p=n(31),v=n(26),f=function(){return document.body.getBoundingClientRect()};t.isIntersect=function(e,t){return!(!e||!t)&&(function(e,t){return e.left<t.left&&e.right>t.left||e.left<t.right&&e.right>t.right||e.left>t.left&&e.right<t.right||e.left<t.left&&e.right>t.right}(e,t)&&function(e,t){return e.top<t.top&&e.bottom>t.top||e.top<t.bottom&&e.bottom>t.bottom||e.top>t.top&&e.bottom<t.bottom||e.top<t.top&&e.bottom>t.bottom}(e,t))};var g=function(e,t){return e.right>=t.right||e.left<=t.left},h=function(e,t){return e.bottom>=t.bottom||e.top<=t.top};t.useFigureOutLayouts=function(e,t,n,i,u,s){var d=a((function(){return f()})),p=d[0],v=d[1],m=a([n]),b=m[0],y=m[1],w=c(0);l((function(){var e=function(){var e=f();v(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var O=r.hooks.useEventCallback((function(t){if(w.current++,w.current>7)return console.warn("Number of cycles: "+w.current+".You may have opened too many panels, and now there is not enough space for them to be placed without overstepping and blocking"),t;var i=function(e,t){return!(!e||!t)&&(g(e,t)||h(e,t))}(t,p);if(!i)return t;var r=t.width,a=t.height,l=t.left,c=t.top,s=t.right,d=t.bottom;if(i){var v=g({left:l,top:c,right:s,bottom:d,width:r,height:a},p),f=h({left:l,top:c,right:s,bottom:d,width:r,height:a},p);v&&(l=e===o.DisplayType.SideBySide?n.x:p.right-r),f||e!==o.DisplayType.SideBySide||(c+=u),s=l+r,d=c+a}return O({left:l,top:c,right:s,bottom:d,width:r,height:a})}));return l((function(){var r=[],a={width:0,height:0};t.forEach((function(t,l){var c=0!==l?r[l-1]:n,s=c.x,d=c.y;e===o.DisplayType.SideBySide?(s+=a.width,s+=0!==l?i:0):e===o.DisplayType.Stack&&(s+=0!==l?i:0,d+=0!==l?u:0);var p={left:s,top:d,right:s+t.width,bottom:d+t.height,width:t.width,height:t.height},v=O(p),f=v.left,g=v.top;w.current>7?(s=c.x,d=c.y):(s=f,d=g),w.current=0,r.push({x:s,y:d}),a=t})),y(r)}),[e,n,i,u,p.width,p.height,O,t]),b},t.useControlledWidgetsSelected=function(e){return i.ReactRedux.useSelector((function(t){var n=t.appRuntimeInfo.selection,r=t.appConfig,o=!1;if(n&&r.layouts[n.layoutId]){var a=r.layouts[n.layoutId].content[n.layoutItemId],l=a&&a.widgetId,u=[];l&&(u=d.searchUtils.getChildrenWidgetsOrSections(r,l,i.LayoutItemType.Widget,!1));var c=[l,e];u&&(c=c.concat(u)),o=c.includes(l)}return o}))},t.useGetWidgetTitle=function(){var e=i.ReactRedux.useSelector((function(e){return e.appConfig.widgets}));return function(t){var n;return null===(n=null==e?void 0:e[t])||void 0===n?void 0:n.label}},t.useWidgetTitle=function(e){return i.ReactRedux.useSelector((function(t){var n,i;return null===(i=null===(n=t.appConfig.widgets)||void 0===n?void 0:n[e])||void 0===i?void 0:i.label}))},t.useWidgetLayouts=function(e,t){return s((function(n){var i,r,o;return null===(o=null===(r=null===(i=n.appConfig.widgets)||void 0===i?void 0:i[e])||void 0===r?void 0:r.layouts)||void 0===o?void 0:o[t]}))},t.useOpeningWidgets=function(e,t){var n=i.ReactRedux.useSelector((function(e){return e.widgetsRuntimeInfo})),r=v.useWidgetIdsOfControllerLayout(e,t),o=u((function(){return Object.keys(n).filter((function(e){var t,r=null===(t=n[e])||void 0===t?void 0:t.state;return!(r!==i.WidgetState.Opened&&r!==i.WidgetState.Active)}))}),[n]);return u((function(){return r.filter((function(e){return o.includes(e)}))}),[r,o])},t.dispatchCloseWidgets=function(e){var t=i.appActions.closeWidgets(e);i.getAppStore().dispatch(t)},t.dispatchCloseWidget=function(e){var t=i.appActions.closeWidget(e);i.getAppStore().dispatch(t)},t.useDispatchCloseOpeningWidgets=function(e,n){var i=t.useOpeningWidgets(e,n);return function(){return t.dispatchCloseWidgets(i)}},t.dispatchOpenWidgets=function(e){var t=i.appActions.openWidgets(e);i.getAppStore().dispatch(t)},t.dispatchOpenWidget=function(e){var t=i.appActions.openWidget(e);i.getAppStore().dispatch(t)},t.dispatchActiveWidget=function(e){var t=i.appActions.activateWidget(e);i.getAppStore().dispatch(t)},t.getListItemLength=function(e,t){var n=null==e?void 0:e.showLabel,i=null==e?void 0:e.labelGrowth,r=null==e?void 0:e.avatar.size,o=null==e?void 0:e.avatar.shape;return p.getItemLength(r,n,o)+t+i}},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DROP_ZONE_PLACEHOLDER_WIDTH=5,t.BASE_LAYOUT_NAME="controller",t.CONTAINER_LAYOUT_NAME="_openwidget",t.MIN_WIDGET_WIDTH=150,t.MIN_WIDGET_HEIGHT=50,t.LABEL_HEIGHT=21,t.WIDGET_ITEM_SIZES={sm:24,default:32,lg:48}},2:function(e,t){e.exports=n},26:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2),o=i.React.useMemo,a=i.ReactRedux.useSelector;t.getWidgetIdsFromLayout=function(e){return t.getVisibleOrderFromLayout(e).map((function(t){var n,i;return null===(i=null===(n=e.content)||void 0===n?void 0:n[t])||void 0===i?void 0:i.widgetId}))},t.getVisibleOrderFromLayout=function(e){var t=(e.order&&e.order.asMutable()||[]).map((function(t){var n;return null===(n=e.content)||void 0===n?void 0:n[t]}));return(t=t.filter((function(e){return e&&!e.isPending}))).map((function(e){return null==e?void 0:e.id}))},t.useWidgetIdsOfControllerLayout=function(e,n){var i=t.useWidgetLayout(e,n);return o((function(){return t.getWidgetIdsFromLayout(i)}),[i])},t.useWidgetLayout=function(e,t){return a((function(n){var i,o,a,l=null===(o=null===(i=(n=n.appContext.isBuilder?n.appStateInBuilder:n).appConfig.widgets)||void 0===i?void 0:i[e])||void 0===o?void 0:o.layouts,u=r.searchUtils.findLayoutId(l[t],n.browserSizeMode,n.appConfig.mainSizeMode);return null===(a=n.appConfig.layouts)||void 0===a?void 0:a[u]}))}},31:function(e,t,n){"use strict";var i=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),l=n(1),u=n(17);t.getItemLength=function(e,t,n){var i=u.WIDGET_ITEM_SIZES[e];return t&&(i+=u.LABEL_HEIGHT),i+=2*s(e,n)};var c,s=function(e,t){return"circle"===t?"sm"===e?4:"default"===e?2:"lg"===e?0:void 0:6};t.AvatarCard=a.React.forwardRef((function(e,n){var u,d=e.label,p=e.className,v=e.title,f=e.showLabel,g=e.labelGrowth,h=void 0===g?0:g,m=e.icon,b=e.marker,y=e.onMarkerClick,w=e.avatar,O=e.autoFlip,I=e.onClick,_=e.active,R=o(e,["label","className","title","showLabel","labelGrowth","icon","marker","onMarkerClick","avatar","autoFlip","onClick","active"]),x=w||{},S=x.shape,j=x.style,E=o(x,["shape","style"]),W=null==E?void 0:E.size,C=a.React.useCallback((function(){var e=t.getItemLength(W,f,S),n=e+h,r=s(W,S);return a.css(c||(c=i(["\n      display: flex;\n      align-items:center;\n      flex-direction: column;\n      justify-content: ",";\n      width: "," !important;\n      height: ",";\n      .avatar {\n        padding: ","px;\n        position: relative;\n        text-align: center;\n        .marker {\n          position: absolute;\n          right: 0;\n          top: 0;\n          padding: 0;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n      }\n      .avatar-label {\n        text-align: center;\n        width: 100%;\n        min-height: ",";\n      }\n    "],["\n      display: flex;\n      align-items:center;\n      flex-direction: column;\n      justify-content: ",";\n      width: "," !important;\n      height: ",";\n      .avatar {\n        padding: ","px;\n        position: relative;\n        text-align: center;\n        .marker {\n          position: absolute;\n          right: 0;\n          top: 0;\n          padding: 0;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n      }\n      .avatar-label {\n        text-align: center;\n        width: 100%;\n        min-height: ",";\n      }\n    "])),f?"space-around":"center",a.polished.rem(n),a.polished.rem(e),r,a.polished.rem(21))}),[W,f,S,h]);return a.jsx(l.Tooltip,{title:v||d},a.jsx("div",r({},R,{onClick:I,ref:n,css:C(),className:a.classNames("avatar-card",p)}),a.jsx("div",{className:"avatar"},!!b&&a.jsx(l.Button,{size:"sm",icon:!0,onClick:y,className:"marker"},a.jsx(l.Icon,{size:10,icon:b})),a.jsx(l.Button,r({icon:!0,active:_,className:"avatar-button"},E,{style:r({borderRadius:"circle"===S?"50%":void 0},j)}),a.jsx(l.Icon,{color:"string"!=typeof m&&(null===(u=m.properties)||void 0===u?void 0:u.color),icon:"string"!=typeof m?m.svg:m,autoFlip:O}))),f&&a.jsx("div",{className:a.classNames("avatar-label text-capitalize text-truncate",{active:_})},d)))}))},32:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},329:function(e,t,n){"use strict";var i=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var r,o,a,l,u,c,s,d=n(0),p=n(330),v=n(17),f=n(1),g=n(334),h=d.ReactRedux.useSelector,m=d.React.useState,b=d.React.useMemo,y=d.React.useRef,w=function(e){var t,n,g,w,O=e.builderSupportModules,I=e.id,_=e.config,R=e.layoutId,x=e.layoutItemId,S=null===(t=_.behavior)||void 0===t?void 0:t.onlyOpenOne,j=null===(n=_.behavior)||void 0===n?void 0:n.displayType,E=null===(g=null==_?void 0:_.behavior)||void 0===g?void 0:g.vertical,W=null==_?void 0:_.appearance.advanced,C=null===(w=null==_?void 0:_.appearance)||void 0===w?void 0:w.card.variant,M=h((function(e){return e.appContext.isInBuilder})),L=h((function(e){return e.appRuntimeInfo.appMode})),T=h((function(e){return e.browserSizeMode})),k=h((function(e){var t,n,i,r,o=null;return M&&(o=null===(r=null===(i=null===(n=null===(t=e.appConfig.layouts)||void 0===t?void 0:t[R])||void 0===n?void 0:n.content)||void 0===i?void 0:i[x])||void 0===r?void 0:r.bbox),o})),P=M&&L!==d.AppMode.Run,A=P&&O.widgetModules.Builder,N=m(0),z=N[0],D=N[1],B=m(null),G=B[0],U=B[1],F=y(null);f.hooks.useUpdateEffect((function(){var e=F.current;if(e){var t=e.getBoundingClientRect();U(t)}}),[k]),f.hooks.useUpdateEffect((function(){D((function(e){return e+1}))}),[S,j,L,T,k]);var H=function(e){return b((function(){return d.css(o||(o=i(["\n      overflow: hidden;\n      white-space: nowrap;\n      .controller-container {\n        width: 100%;\n        height: 100%;\n        min-width: ",";\n        min-height: ",";\n      }\n      ",";\n    "],["\n      overflow: hidden;\n      white-space: nowrap;\n      .controller-container {\n        width: 100%;\n        height: 100%;\n        min-width: ",";\n        min-height: ",";\n      }\n      ",";\n    "])),e?d.polished.rem(v.MIN_WIDGET_HEIGHT):d.polished.rem(v.MIN_WIDGET_WIDTH),e?d.polished.rem(v.MIN_WIDGET_WIDTH):d.polished.rem(v.MIN_WIDGET_HEIGHT),e&&d.css(r||(r=i(["\n      .roll-list {\n        .content {\n          width: 100%;\n        }\n      }\n      .layout-item-list {\n        &.icon-list {\n          width: 100%;\n        }\n      }\n        .layout-item {\n          width: 100%;\n        }\n        .avatar-card {\n            width: 100% !important;\n          }\n      "],["\n      .roll-list {\n        .content {\n          width: 100%;\n        }\n      }\n      .layout-item-list {\n        &.icon-list {\n          width: 100%;\n        }\n      }\n        .layout-item {\n          width: 100%;\n        }\n        .avatar-card {\n            width: 100% !important;\n          }\n      "]))))}),[e])}(E),V=function(e,t){var n=null==e?void 0:e.default,r=null==e?void 0:e.active,o=null==e?void 0:e.hover;return b((function(){return t?d.css(s||(s=i(["\n      .avatar-card:not(.add-widget-btn) {\n        ","\n        ","\n        ","\n      }\n    "],["\n      .avatar-card:not(.add-widget-btn) {\n        ","\n        ","\n        ","\n      }\n    "])),n&&d.css(l||(l=i(["\n          > .avatar {\n            > .avatar-button {\n              background-color: ",";\n              border-color: ",";\n            }\n          }\n          > .avatar-label {\n            color: ",";\n            font-style: ",";\n            font-weight: ",";\n            text-decoration: ",";\n          }\n        "],["\n          > .avatar {\n            > .avatar-button {\n              background-color: ",";\n              border-color: ",";\n            }\n          }\n          > .avatar-label {\n            color: ",";\n            font-style: ",";\n            font-weight: ",";\n            text-decoration: ",";\n          }\n        "])),n.bg,n.bg,n.color,(null==n?void 0:n.italic)?"italic":"normal",(null==n?void 0:n.bold)?"bold":"normal",f.styleUtils.toCSSTextUnderLine({underline:n.underline,strike:n.strike})),o&&d.css(u||(u=i(["\n          &:hover {\n            > .avatar {\n              > .avatar-button {\n                background-color: ",";\n                border-color: ",";\n              }\n            }\n            > .avatar-label {\n              color: ",";\n              font-style: ",";\n              font-weight: ",";\n              text-decoration: ",";\n            }\n          }\n        "],["\n          &:hover {\n            > .avatar {\n              > .avatar-button {\n                background-color: ",";\n                border-color: ",";\n              }\n            }\n            > .avatar-label {\n              color: ",";\n              font-style: ",";\n              font-weight: ",";\n              text-decoration: ",";\n            }\n          }\n        "])),o.bg,o.bg,o.color,(null==o?void 0:o.italic)?"italic":"normal",(null==o?void 0:o.bold)?"bold":"normal",f.styleUtils.toCSSTextUnderLine({underline:o.underline,strike:o.strike})),r&&d.css(c||(c=i(['\n            > .avatar {\n              > .avatar-button {\n                &:not(:disabled):not(.disabled):active,\n                &:not(:disabled):not(.disabled).active,\n                &[aria-expanded="true"] {\n                  background-color: ',";\n                  border-color: ",";\n                }\n              }\n            }\n            > .avatar-label {\n              &:not(:disabled):not(.disabled):active,\n              &:not(:disabled):not(.disabled).active {\n                color: ",";\n                font-style: ",";\n                font-weight: ",";\n                text-decoration: ",";\n              }\n            }\n        "],['\n            > .avatar {\n              > .avatar-button {\n                &:not(:disabled):not(.disabled):active,\n                &:not(:disabled):not(.disabled).active,\n                &[aria-expanded="true"] {\n                  background-color: ',";\n                  border-color: ",";\n                }\n              }\n            }\n            > .avatar-label {\n              &:not(:disabled):not(.disabled):active,\n              &:not(:disabled):not(.disabled).active {\n                color: ",";\n                font-style: ",";\n                font-weight: ",";\n                text-decoration: ",";\n              }\n            }\n        "])),r.bg,r.bg,r.color,(null==r?void 0:r.italic)?"italic":"normal",(null==r?void 0:r.bold)?"bold":"normal",f.styleUtils.toCSSTextUnderLine({underline:r.underline,strike:r.strike}))):d.css(a||(a=i([""],[""])))}),[t,n,r,o])}(C,W);return d.jsx("div",{className:"widget-controller jimu-widget shadow",css:[H,V],ref:F},d.jsx("div",{className:"controller-container"},!P&&d.jsx(p.Runtime,{id:I,version:z,config:_,forbidden:G}),P&&A&&d.jsx(A,{id:I,version:z,config:_})))};w.versionManager=g.versionManager,t.default=w},330:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,r++)i[r]=o[a];return i};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),l=n(15),u=n(2),c=n(331),s=n(332),d=n(333),p=n(54),v=n(66),f=n(17),g=n(26),h=o.ReactRedux.useSelector,m=o.React.useEffect,b=o.React.useState,y=o.React.useCallback,w=o.React.useMemo,O=o.React.useRef,I={x:70,y:70};t.Runtime=function(e){var t,n,_,R,x,S,j,E,W,C=e.id,M=e.config,L=e.version,T=e.forbidden,k=null===(t=M.behavior)||void 0===t?void 0:t.onlyOpenOne,P=null===(n=M.behavior)||void 0===n?void 0:n.openStarts,A=null===(_=M.behavior)||void 0===_?void 0:_.size,N=null===(R=M.behavior)||void 0===R?void 0:R.vertical,z=null===(x=M.behavior)||void 0===x?void 0:x.displayType,D=null===(S=null==M?void 0:M.appearance)||void 0===S?void 0:S.card,B=function(e){return h((function(t){var n=t.appConfig,i=t.browserSizeMode,r=t.appRuntimeInfo.sectionNavInfos,a=u.searchUtils.getWidgetOrSectionContainerInfo(n,e,o.LayoutItemType.Widget,i),l=Object.keys(r||{}).map((function(e){return r[e].currentViewId})),c=!0;return a&&a.type===o.ContainerType.View&&(c=l.includes(a.id)),c}))}(C),G=function(e){return h((function(t){var n,i=t.appConfig,r=t.browserSizeMode,a=u.searchUtils.getParentWidgetIdOfWidgetOrSection(i,e,o.LayoutItemType.Widget,r),l=i.widgets[a];return"arcgis-map"===(null===(n=null==l?void 0:l.manifest)||void 0===n?void 0:n.name)?l.id:""}))}(C),U=h((function(e){return e.appContext.isInBuilder})),F=a.hooks.useCheckSmallBrowserSzieMode(),H=h((function(e){return e.appRuntimeInfo.currentPageId})),V=O(),Y=g.useWidgetIdsOfControllerLayout(C,f.BASE_LAYOUT_NAME),Z=l.useOpeningWidgets(C,f.BASE_LAYOUT_NAME),K=l.useDispatchCloseOpeningWidgets(C,f.BASE_LAYOUT_NAME),X=b(null),q=X[0],J=X[1],Q=b(P||[]),$=Q[0],ee=Q[1],te=w((function(){return $.map((function(e){return{id:e,opening:Z.includes(e)}}))}),[$,Z]),ne=null==Z?void 0:Z[0],ie=N?"right-start":"bottom",re=y((function(e){var t,n=e.currentTarget,i=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid;if(i&&n){J(n);var o=$;$.includes(i)||(o=r(o,[i]),ee(o)),!!F||k?(K(),Z.includes(i)||l.dispatchOpenWidget(i)):Z.includes(i)?l.dispatchCloseWidget(i):l.dispatchOpenWidget(i)}}),[$,Z,F,k,K]),oe=function(e){e&&l.dispatchCloseWidget(e)};m((function(){!U&&(null==P?void 0:P.length)&&(k?setTimeout((function(){var e,t=function(e){return document&&document.querySelector(".widget-controller .avatar-card[data-widgetid='"+e+"']")}(P[0]);J(t||(null===(e=V.current)||void 0===e?void 0:e.ref.current)),l.dispatchOpenWidgets(P)}),1e3):l.dispatchOpenWidgets(P))}),[]),a.hooks.useUpdateEffect((function(){K(),ee([])}),[L]),a.hooks.useUpdateEffect((function(){K(),ee([])}),[H]),a.hooks.useUpdateEffect((function(){B||(K(),ee([]))}),[B]);var ae=y((function(e,t){var n=Z.includes(e);return o.React.createElement(v.WidgetAvatarCard,i({key:e,className:t,widgetid:e,showMarker:!1},D,{active:n,onClick:re}))}),[D,Z,re]),le=l.getListItemLength(null===(j=null==M?void 0:M.appearance)||void 0===j?void 0:j.card,null===(E=null==M?void 0:M.appearance)||void 0===E?void 0:E.space);return o.React.createElement(o.React.Fragment,null,F&&o.React.createElement(c.MobileWidgetLuncher,{widgetId:ne,containerMapId:G,onClose:oe}),!F&&o.React.createElement(o.React.Fragment,null,k&&o.React.createElement(s.SingleWidgetsLuncher,{onClose:oe,openedWidgets:te,sizes:A,widgetIds:Y,reference:q,placement:ie}),!k&&o.React.createElement(d.MultipleWidgetsLuncher,{mode:z,start:I,spaceX:30,spaceY:30,sizes:A,widgetIds:Y,onClose:oe,forbidden:T,openedWidgets:te})),o.React.createElement(p.ScrollList,{ref:V,itemLength:le,space:null===(W=M.appearance)||void 0===W?void 0:W.space,autoHideArrow:!0,lists:Y,createItem:ae}))}},331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),o=n(15),a=n(87);t.MobileWidgetLuncher=function(e){var t=e.widgetId,n=e.containerMapId,l=e.onClose,u=o.useWidgetTitle(t),c=i.React.useCallback((function(e,t){null==t||t.stopPropagation(),null==t||t.nativeEvent.stopImmediatePropagation(),null==l||l(e)}),[l]);return i.React.createElement(r.MobilePanel,{mapWidgetId:n,title:u,open:!!t,toggle:function(){return c(t)}},i.React.createElement(a.WidgetRenderer,{widgetId:t}))}},332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),o=n(15),a=n(87),l={width:150,height:120},u={width:300,height:300},c={bounds:"body"};t.SingleWidgetsLuncher=function(e){var t=e.reference,n=e.placement,s=e.sizes,d=e.widgetIds,p=e.openedWidgets,v=e.onClose,f=i.React.useState((function(){return function(e,t){var n=i.Immutable({});return e.forEach((function(e){n=n.set(e,t[e]||u)})),n}(d,s)})),g=f[0],h=f[1],m=i.React.useMemo((function(){var e;return(null!==(e=null==p?void 0:p.map((function(e){return e.id})))&&void 0!==e?e:[]).map((function(e){return g[e]}))}),[g,p]),b=o.useGetWidgetTitle();return i.React.createElement(i.React.Fragment,null,p.map((function(e,o){var u=e.id,s=e.opening,d=m[o],p=b(u);return i.React.createElement(r.Popper,{key:u,title:p,minSize:l,draggableProps:c,defaultSize:d,onResize:function(e){return t=u,n=e,void h(g.set(t,n));var t,n},onTriggerClose:function(e){return function(e,t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),null==v||v(e)}(u,e)},floating:!0,open:s,reference:t,placement:n},i.React.createElement(a.WidgetRenderer,{widgetId:u}))})))}},333:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),o=n(15),a=n(87),l=i.React.useState,u=i.React.useMemo,c={width:300,height:300};t.MultipleWidgetsLuncher=function(e){var t=e.mode,n=e.start,s=e.spaceX,d=e.spaceY,p=e.sizes,v=e.widgetIds,f=e.openedWidgets,g=e.onClose,h=e.forbidden,m=l((function(){return function(e,t){var n=i.Immutable({});return e.forEach((function(e){n=n.set(e,t[e]||c)})),n}(v,p)})),b=m[0],y=m[1],w=o.useGetWidgetTitle(),O=u((function(){var e;return(null!==(e=null==f?void 0:f.map((function(e){return e.id})))&&void 0!==e?e:[]).map((function(e){return b[e]}))}),[b,f]),I=o.useFigureOutLayouts(t,O,n,s,d,h);return i.React.createElement(i.React.Fragment,null,f.map((function(e,t){var n=e.id,o=e.opening,l=I[t];if(l){var u=O[t],c=w(n);return i.React.createElement(r.FloatingPanel,{key:n,title:c,defaultPosition:l,defaultSize:u,className:i.classNames({"d-none":!o}),showClose:!0,draggableProps:{bounds:"body"},onResize:function(e){return t=n,i=e,void y(b.set(t,i));var t,i},onTriggerClose:function(e){return function(e,t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),null==g||g(e)}(n,e)}},i.React.createElement(a.WidgetRenderer,{widgetId:n}))}})))}},334:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.DEFAULT_CONFIG={behavior:{onlyOpenOne:!0,openStarts:[],displayType:"STACK",vertical:!1,size:{}},appearance:{space:0,advanced:!1,card:{showLabel:!1,labelGrowth:10,avatar:{type:"primary",size:"default",shape:"circle"}}}};var a=function(e){return"SMALL"===e?"sm":"MEDIUM"===e?"default":"LARGE"===e?"lg":e},l=function(e,t){return void 0===t&&(t="primary"),null==e?void 0:e[t]},u=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.versions=[{version:"1.0.0",description:"Version manager for release 1.0.0",upgrader:function(e){if(!e)return t.DEFAULT_CONFIG;if(e.behavior&&e.appearance)return e;var n=e;return e.behavior||(n=(n=(n=(n=(n=(n=n.setIn(["behavior","openStarts"],[])).setIn(["behavior","onlyOpenOne"],e.onlyOpenOne)).setIn(["behavior","displayType"],e.displayType)).setIn(["behavior","vertical"],e.vertical)).setIn(["behavior","size"],e.size)).without(["onlyOpenOne","displayType","size"])),e.appearance||(n=n.setIn(["appearance","advanced"],!1),n=(n=(n=(n=(n=(n=e.vertical?n.setIn(["appearance","space"],e.space):(n=n.setIn(["appearance","space"],0)).setIn(["appearance","card","labelGrowth"],e.space)).setIn(["appearance","card","showLabel"],e.showLabel)).setIn(["appearance","card","avatar","size"],a(e.iconSize))).setIn(["appearance","card","avatar","shape"],e.iconStyle)).setIn(["appearance","card","avatar","type"],"primary")).without(["space","showLabel","iconSize","iconStyle","vertical"])),n}},{version:"1.1.0",description:"Version manager for release 1.1.0",upgrader:function(e){var n,i;if(!e)return t.DEFAULT_CONFIG;var r=null===(n=null==e?void 0:e.appearance)||void 0===n?void 0:n.card,o=null==r?void 0:r.variants,a=null===(i=null==r?void 0:r.avatar)||void 0===i?void 0:i.type,u=e;if(o){var c=l(o,a);r=null==r?void 0:r.set("variant",c).without("variants"),u=u.setIn(["appearance","card"],r)}return u}}],n}return r(n,e),n}(o.BaseVersionManager);t.versionManager=new u},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Stack="STACK",e.SideBySide="SIDEBYSIDE"}(t.DisplayType||(t.DisplayType={}))},54:function(e,t,n){"use strict";var i=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(0),u=n(1),c=l.React.useRef,s=l.React.useEffect,d=l.React.useState,p=l.React.useImperativeHandle,v=l.React.forwardRef;t.ScrollList=v((function(e,t){var n,v,f=e.className,g=e.lists,h=void 0===g?[]:g,m=e.createItem,b=e.vertical,y=e.itemLength,w=e.space,O=e.onChange,I=(e.autoHideArrow,e.placeholder),_=e.minLength,R=void 0===_?y:_,x=e.autoScrollEnd,S=o(e,["className","lists","createItem","vertical","itemLength","space","onChange","autoHideArrow","placeholder","minLength","autoScrollEnd"]),j=b?"clientHeight":"clientWidth",E=null!==(n=null==h?void 0:h.length)&&void 0!==n?n:0,W=null!==(v=null==I?void 0:I.length)&&void 0!==v?v:y,C=null==I?void 0:I.node,M=null==I?void 0:I.position,L=function(e,t,n){return l.css(a||(a=i(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    .root {\n      flex-direction: ",";\n      width: 100%;\n      height: 100%;\n      min-width: ",";\n      display: flex;\n      justify-content: center;\n      flex-wrap: nowrap;\n      align-items: center;\n      .scroll-list-item:not(:first-of-type) {\n        margin-top: ",";\n        margin-left: ",";\n    }\n  }\n"],["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    .root {\n      flex-direction: ",";\n      width: 100%;\n      height: 100%;\n      min-width: ",";\n      display: flex;\n      justify-content: center;\n      flex-wrap: nowrap;\n      align-items: center;\n      .scroll-list-item:not(:first-of-type) {\n        margin-top: ",";\n        margin-left: ",";\n    }\n  }\n"])),e?"column":"row",l.polished.rem(n),e?l.polished.rem(t):"unset",e?"unset":l.polished.rem(t))}(b,w,R),T=c(null),k=d(0),P=k[0],A=k[1],N=d(0),z=N[0],D=N[1],B=d(0),G=B[0],U=B[1],F=d(0),H=F[0],V=F[1],Y=d(!0),Z=Y[0],K=Y[1],X=d(!1),q=X[0],J=X[1],Q=d(!0),$=Q[0],ee=Q[1],te=u.hooks.useRefValue(H),ne=u.hooks.useRefValue(G),ie=u.hooks.useRefValue(z);p(t,(function(){return{hideArrow:$,disablePrevious:Z,disableNext:q,scroll:oe,ref:T}})),s((function(){var e=T.current,t=l.lodash.debounce(A,500);function n(){var n=e[j]||0;n+=w,n-=C?W:0,n=Math.max(n,R),t(n)}var i=new l.ResizeObserver((function(){n()}));return i.observe(e),e&&n(),function(){i.disconnect(),null==t||t.cancel()}}),[]),s((function(){var e=Math.floor(P/y);D(e)}),[P,y]),s((function(){var e=ne.current,t=te.current;t-e>z?t=ne.current+z:t-e<z&&(t=(e=0)+z),U(e),V(t)}),[z]);var re=c([]);s((function(){if(x&&h.length>0&&re.current.length>0&&h[h.length-1]!==re.current[re.current.length-1]){var e,t=0;t=(e=E)-ie.current,t=Math.max(0,t),U(t),V(e)}re.current=h}),[h]);var oe=u.hooks.useEventCallback((function(e,t){void 0===t&&(t=!0);var n=t?1:z,i=0,r=0;e?r=(i=G-n)<0?(i=0)+z:H-n:i=(r=H+n)>E?(r=E)-z:G+n,U(i),V(r)}));return s((function(){var e=H-G>=E,t=H===E;K(0===G),J(t),ee(e)}),[G,H,E]),l.jsx(u.NavButtonGroup,r({},S,{css:L,type:"tertiary",vertical:b,onChange:function(e){null==O||O(e),oe(e,!0)},disablePrevious:Z,disableNext:q,previousStyle:{visibility:$?"hidden":"visible"},nextStyle:{visibility:$?"hidden":"visible"},className:l.classNames("scroll-list",f)}),l.jsx("div",{className:"root scroll-list-root",ref:T},"start"===M&&C,h.slice(G,H).map((function(e){return m(e,"scroll-list-item")})),"end"===M&&C))}))},66:function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(88)),i(n(31)),i(n(54)),i(n(15))},87:function(e,t,n){"use strict";var i=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(0),u=n(1),c=n(15),s=l.React.useEffect;t.WidgetRenderer=function(e){var t,n=e.widgetId,d=(e.canCrossLayoutBoundary,e.className),p=o(e,["widgetId","canCrossLayoutBoundary","className"]),v=l.ReactRedux.useSelector((function(e){var t,i;return null===(i=null===(t=e.widgetsRuntimeInfo)||void 0===t?void 0:t[n])||void 0===i?void 0:i.isClassLoaded})),f=l.ReactRedux.useSelector((function(e){var t,i;return(null===(i=null===(t=e.widgetsRuntimeInfo)||void 0===t?void 0:t[n])||void 0===i?void 0:i.state)===l.WidgetState.Active}));s((function(){n&&!v&&l.WidgetManager.getInstance().loadWidgetClass(n)})),n&&(t=l.WidgetManager.getInstance().getWidgetClass(n));var g=l.classNames("widget-renderer  w-100",d),h=function(e){return l.css(a||(a=i(["\n      overflow: ",";\n      position: relative;\n      .widget-content {\n        position: relative;\n        height: 100%;\n        width: 100%;\n        z-index: 0;\n      }\n  "],["\n      overflow: ",";\n      position: relative;\n      .widget-content {\n        position: relative;\n        height: 100%;\n        width: 100%;\n        z-index: 0;\n      }\n  "])),e?"visible":"hidden")}();return l.jsx("div",r({css:h,className:g,onMouseDownCapture:function(){window.jimuConfig.isBuilder||f||c.dispatchActiveWidget(n)}},p),l.jsx("div",{className:"widget-content p-1"},t&&l.jsx(l.ErrorBoundary,null,l.jsx(t,null)),!t&&l.jsx(u.Loading,null)))}},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(31),o=n(1),a=n(32);t.WidgetAvatarCard=function(e){var t,n,l=e.showMarker,u=e.onMarkerClick,c=e.widgetid,s=e.showLabel,d=e.labelGrowth,p=e.avatar,v=e.onClick,f=e.active,g=e.className,h=i.ReactRedux.useSelector((function(e){var t;return null===(t=e.appConfig.widgets)||void 0===t?void 0:t[c]}));return h?i.React.createElement(r.AvatarCard,{"data-widgetid":c,showLabel:s,labelGrowth:d,avatar:p,label:h.label,icon:h.icon,autoFlip:null===(n=null===(t=null==h?void 0:h.manifest)||void 0===t?void 0:t.properties)||void 0===n?void 0:n.flipIcon,marker:l?a:"",onMarkerClick:u,onClick:v,active:f,className:g}):i.React.createElement(o.Loading,null)}}})}));