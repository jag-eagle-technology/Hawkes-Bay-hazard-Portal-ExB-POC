define(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-for-builder","jimu-ui/advanced/data-source-selector"],(function(t,e,n,o,s,i){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(o,s,function(e){return t[e]}.bind(null,s));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=281)}({0:function(e,n){e.exports=t},1:function(t,n){t.exports=e},281:function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(1),r=n(3),p=n(6),l=n(4),c=n(5),u=n(282),d=n(283),h=n(284),g=function(t){function e(e){var n=t.call(this,e)||this;return n.supportedDsTypes=i.Immutable([l.DataSourceTypes.WebMap,l.DataSourceTypes.WebScene]),n.getPortUrl=function(){return i.getAppStore().getState().portalUrl},n.onRadioChange=function(t){n.props.onSettingChange({id:n.props.id,config:n.props.config.set("useMapWidget",t)}),n.setState({useMapWidget:t})},n.onToolsChanged=function(t,e){n.props.onSettingChange({id:n.props.id,config:n.props.config.set(e,t)})},n.onOptionsChanged=function(t,e){n.props.onSettingChange({id:n.props.id,config:n.props.config.set(e,t)})},n.onToggleUseDataEnabled=function(t){n.props.onSettingChange({id:n.props.id,useDataSourcesEnabled:t})},n.onDataSourceChange=function(t){t&&n.props.onSettingChange({id:n.props.id,useDataSources:t})},n.onMapWidgetSelected=function(t){n.props.onSettingChange({id:n.props.id,useMapWidgetIds:t})},n.state={useMapWidget:n.props.config.useMapWidget||!1},n}return s(e,t),e.prototype.render=function(){var t,e,n,o=this,s=this.getPortUrl(),l=null,c=null,g=null;return e=i.jsx("div",{className:"data-selector-section"},i.jsx(r.SettingRow,null,i.jsx(p.DataSourceSelector,{types:this.supportedDsTypes,useDataSources:this.props.useDataSources,useDataSourcesEnabled:!0,mustUseDataSource:!0,onChange:this.onDataSourceChange,widgetId:this.props.id})),s&&this.props.dsJsons&&this.props.useDataSources&&1===this.props.useDataSources.length&&i.jsx(r.SettingRow,null,i.jsx("div",{className:"w-100"},i.jsx("div",{className:"webmap-thumbnail",title:null===(t=this.props.dsJsons[this.props.useDataSources[0].dataSourceId])||void 0===t?void 0:t.label},i.jsx(d.default,{mapItemId:this.props.dsJsons[this.props.useDataSources[0].dataSourceId]?this.props.dsJsons[this.props.useDataSources[0].dataSourceId].itemId:null,portUrl:this.props.dsJsons[this.props.useDataSources[0].dataSourceId]?this.props.dsJsons[this.props.useDataSources[0].dataSourceId].portalUrl:null}))))),n=i.jsx("div",{className:"map-selector-section"},i.jsx(r.SettingRow,null,i.jsx(r.JimuMapViewSelector,{onSelect:this.onMapWidgetSelected,useMapWidgetIds:this.props.useMapWidgetIds}))),this.state.useMapWidget?(l=n,c=i.jsx(i.React.Fragment,null,i.jsx(r.SettingRow,{label:i.jsx(i.FormattedMessage,{id:"goto",defaultMessage:u.default.goto})},i.jsx(a.Switch,{className:"can-x-switch",checked:this.props.config&&this.props.config.goto||!1,"data-key":"goto",onChange:function(t){o.onToolsChanged(t.target.checked,"goto")}})),i.jsx(r.SettingRow,{label:i.jsx(i.FormattedMessage,{id:"transparency",defaultMessage:u.default.transparency})},i.jsx(a.Switch,{className:"can-x-switch",checked:this.props.config&&this.props.config.opacity||!1,"data-key":"opacity",onChange:function(t){o.onToolsChanged(t.target.checked,"opacity")}}))),g=i.jsx(r.SettingRow,{label:i.jsx(i.FormattedMessage,{id:"setVisibility",defaultMessage:u.default.setVisibility})},i.jsx(a.Switch,{className:"can-x-switch",checked:this.props.config&&this.props.config.setVisibility||!1,"data-key":"setVisibility",onChange:function(t){o.onOptionsChanged(t.target.checked,"setVisibility")}}))):l=e,i.jsx("div",{css:h.getStyle(this.props.theme)},i.jsx("div",{className:"widget-setting-layerlist"},i.jsx(r.SettingSection,{title:this.props.intl.formatMessage({id:"sourceLabel",defaultMessage:u.default.sourceLabel})},i.jsx(r.SettingRow,null,i.jsx("div",{className:"layerlist-tools w-100"},i.jsx("div",{className:"w-100"},i.jsx("div",{className:"layerlist-tools-item radio"},i.jsx(a.Radio,{id:"map-data",style:{cursor:"pointer"},name:"map-data",onChange:function(t){return o.onRadioChange(!1)},checked:!this.state.useMapWidget}),i.jsx(a.Label,{style:{cursor:"pointer"},for:"map-data",className:"ml-1"},this.props.intl.formatMessage({id:"showLayerForMap",defaultMessage:u.default.showLayerForMap})))),i.jsx("div",{className:"w-100"},i.jsx("div",{className:"layerlist-tools-item radio"},i.jsx(a.Radio,{id:"map-view",style:{cursor:"pointer"},name:"map-view",onChange:function(t){return o.onRadioChange(!0)},checked:this.state.useMapWidget}),i.jsx(a.Label,{style:{cursor:"pointer"},for:"map-view",className:"ml-1"},this.props.intl.formatMessage({id:"interactWithMap",defaultMessage:u.default.interactWithMap})))))),l),i.jsx(r.SettingSection,{title:this.props.intl.formatMessage({id:"options",defaultMessage:u.default.options})},c,i.jsx(r.SettingRow,{label:i.jsx(i.FormattedMessage,{id:"information",defaultMessage:u.default.information})},i.jsx(a.Switch,{className:"can-x-switch",checked:this.props.config&&this.props.config.information||!1,"data-key":"information",onChange:function(t){o.onToolsChanged(t.target.checked,"information")}})),g)))},e.mapExtraStateProps=function(t){return{dsJsons:t.appStateInBuilder.appConfig.dataSources}},e}(c.BaseWidgetSetting);e.default=g},282:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={sourceLabel:"Source",sourceDescript:"A web map or web scene, or any combination of the two.",actions:"Actions",goto:"Zoom to",transparency:"Adjust layer transparency",information:"View layer details",options:"Options",setVisibility:"Toggle layer visibility",showLayerForMap:"Show layers for map data only",interactWithMap:"Interact with a Map widget"}},283:function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(1),r=function(t){function e(e){var n=t.call(this,e)||this;return n.unmount=!1,n.setMapThumbUrl=function(t){if(t||n.setState({mapThumbUrl:null}),n.props.portUrl&&n.props.portUrl!==i.getAppStore().getState().portalUrl)i.esri.restPortal.searchItems({q:"id:"+t,portal:n.props.portUrl+"/sharing/rest"}).then((function(t){if(!n.unmount)if(t.results[0]){var e=n.props.portUrl+"/sharing/rest/content/items/"+t.results[0].id+"/info/"+t.results[0].thumbnail;n.setState({mapThumbUrl:e})}else n.setState({mapThumbUrl:null})}));else{var e=i.getAppStore().getState().portalUrl,o=i.SessionManager.getInstance().getSessionByUrl(e);i.esri.restPortal.searchItems({q:"id:"+t,authentication:i.SessionManager.getInstance().getSessionByUrl(e),portal:e+"/sharing/rest"}).then((function(t){if(!n.unmount)if(t.results[0]){var s=e+"/sharing/rest/content/items/"+t.results[0].id+"/info/"+t.results[0].thumbnail+"?token="+(null==o?void 0:o.token);n.setState({mapThumbUrl:s})}else n.setState({mapThumbUrl:null})}))}},n.state={mapThumbUrl:null},n}return s(e,t),e.prototype.componentDidMount=function(){this.unmount=!1,this.setMapThumbUrl(this.props.mapItemId)},e.prototype.componentDidUpdate=function(t,e){t.mapItemId!==this.props.mapItemId&&this.setMapThumbUrl(this.props.mapItemId)},e.prototype.componentWillUnmount=function(){this.unmount=!0},e.prototype.render=function(){return this.state.mapThumbUrl?i.React.createElement(a.ImageWithParam,{imageParam:{url:this.state.mapThumbUrl}}):i.React.createElement(a.ImageWithParam,{imageParam:{}})},e}(i.React.PureComponent);e.default=r},284:function(t,e,n){"use strict";var o=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};Object.defineProperty(e,"__esModule",{value:!0});var s,i=n(0);e.getStyle=function(t){return i.css(s||(s=o(["\n    .widget-setting-layerlist{\n      font-weight: lighter;\n      font-size: 13px;\n\n      .source-descript {\n        color: ",";\t\n      }\n\n      .webmap-thumbnail{\n        cursor: auto;\n        width: 100%;\n        height: 120px;\n        overflow: hidden;\n        padding: 1px;\n        border: "," solid initial;\n        img, div{\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .layerlist-tools{\n        .layerlist-tools-item{\n          display: flex;\n          /* justify-content: space-between; */\n          margin-bottom: 8px;\n        }\n      }\n\n      .map-selector-section .component-map-selector .form-control{\n        width: 100%;\n      }\n\n      .data-selector-section, .map-selector-section{\n        padding-top: 10px;\n      }\n\n    }\n  "],["\n    .widget-setting-layerlist{\n      font-weight: lighter;\n      font-size: 13px;\n\n      .source-descript {\n        color: ",";\t\n      }\n\n      .webmap-thumbnail{\n        cursor: auto;\n        width: 100%;\n        height: 120px;\n        overflow: hidden;\n        padding: 1px;\n        border: "," solid initial;\n        img, div{\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .layerlist-tools{\n        .layerlist-tools-item{\n          display: flex;\n          /* justify-content: space-between; */\n          margin-bottom: 8px;\n        }\n      }\n\n      .map-selector-section .component-map-selector .form-control{\n        width: 100%;\n      }\n\n      .data-selector-section, .map-selector-section{\n        padding-top: 10px;\n      }\n\n    }\n  "])),t.colors.palette.dark[600],i.polished.rem(2))}},3:function(t,e){t.exports=n},4:function(t,e){t.exports=o},5:function(t,e){t.exports=s},6:function(t,e){t.exports=i}})}));