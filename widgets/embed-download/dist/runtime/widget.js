define(["jimu-core","jimu-ui"], function(__WEBPACK_EXTERNAL_MODULE_jimu_core__, __WEBPACK_EXTERNAL_MODULE_jimu_ui__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./your-extensions/widgets/embed-download/src/runtime/widget.tsx");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./your-extensions/widgets/embed-download/src/config.ts":
/*!**************************************************************!*\
  !*** ./your-extensions/widgets/embed-download/src/config.ts ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EmbedType;\r\n(function (EmbedType) {\r\n    EmbedType[\"Url\"] = \"url\";\r\n    EmbedType[\"Code\"] = \"code\";\r\n})(EmbedType = exports.EmbedType || (exports.EmbedType = {}));\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvY29uZmlnLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4veW91ci1leHRlbnNpb25zL3dpZGdldHMvZW1iZWQtZG93bmxvYWQvc3JjL2NvbmZpZy50cz8yMzRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW1tdXRhYmxlT2JqZWN0LCBFeHByZXNzaW9ufSBmcm9tICdqaW11LWNvcmUnO1xyXG5cclxuZXhwb3J0IGVudW0gRW1iZWRUeXBle1xyXG4gIFVybCA9ICd1cmwnLFxyXG4gIENvZGUgPSAnY29kZSdcclxufVxyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlne1xyXG4gIGVtYmVkVHlwZTogRW1iZWRUeXBlLFxyXG4gIGVtYmVkQ29kZTogc3RyaW5nLFxyXG4gIHN0YXRpY1VybDogc3RyaW5nLFxyXG4gIGV4cHJlc3Npb246IEV4cHJlc3Npb25cclxufVxyXG5cclxuZXhwb3J0IHR5cGUgSU1Db25maWcgPSBJbW11dGFibGVPYmplY3Q8Q29uZmlnPjtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./your-extensions/widgets/embed-download/src/config.ts\n");

/***/ }),

/***/ "./your-extensions/widgets/embed-download/src/embed-version-manager.ts":
/*!*****************************************************************************!*\
  !*** ./your-extensions/widgets/embed-download/src/embed-version-manager.ts ***!
  \*****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar jimu_core_1 = __webpack_require__(/*! jimu-core */ \"jimu-core\");\r\nvar config_1 = __webpack_require__(/*! ./config */ \"./your-extensions/widgets/embed-download/src/config.ts\");\r\nvar VersionManager = /** @class */ (function (_super) {\r\n    __extends(VersionManager, _super);\r\n    function VersionManager() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.versions = [{\r\n                version: '1.0.0',\r\n                description: 'The first release.',\r\n                upgrader: function (oldConfig) {\r\n                    var _a, _b;\r\n                    var embedType = (_a = oldConfig === null || oldConfig === void 0 ? void 0 : oldConfig.functionConfig) === null || _a === void 0 ? void 0 : _a.embedType;\r\n                    var content = (_b = oldConfig === null || oldConfig === void 0 ? void 0 : oldConfig.functionConfig) === null || _b === void 0 ? void 0 : _b.content;\r\n                    if (embedType) {\r\n                        oldConfig = oldConfig.set('embedType', embedType);\r\n                        if (embedType === config_1.EmbedType.Url) {\r\n                            oldConfig = oldConfig.set('staticUrl', content);\r\n                        }\r\n                        else {\r\n                            oldConfig = oldConfig.set('embedCode', content);\r\n                        }\r\n                    }\r\n                    else {\r\n                        oldConfig = oldConfig.set('embedType', config_1.EmbedType.Url);\r\n                    }\r\n                    oldConfig = oldConfig.without('functionConfig');\r\n                    return oldConfig;\r\n                }\r\n            }];\r\n        return _this;\r\n    }\r\n    return VersionManager;\r\n}(jimu_core_1.BaseVersionManager));\r\nexports.versionManager = new VersionManager();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvZW1iZWQtdmVyc2lvbi1tYW5hZ2VyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4veW91ci1leHRlbnNpb25zL3dpZGdldHMvZW1iZWQtZG93bmxvYWQvc3JjL2VtYmVkLXZlcnNpb24tbWFuYWdlci50cz9iMmQ5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VWZXJzaW9uTWFuYWdlciB9IGZyb20gJ2ppbXUtY29yZSc7XHJcbmltcG9ydCB7IEVtYmVkVHlwZSB9IGZyb20gJy4vY29uZmlnJztcclxuXHJcbmNsYXNzIFZlcnNpb25NYW5hZ2VyIGV4dGVuZHMgQmFzZVZlcnNpb25NYW5hZ2Vye1xyXG4gIHZlcnNpb25zID0gW3tcclxuICAgIHZlcnNpb246ICcxLjAuMCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1RoZSBmaXJzdCByZWxlYXNlLicsXHJcbiAgICB1cGdyYWRlcjogKG9sZENvbmZpZykgPT4ge1xyXG4gICAgICBjb25zdCBlbWJlZFR5cGUgPSBvbGRDb25maWc/LmZ1bmN0aW9uQ29uZmlnPy5lbWJlZFR5cGU7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBvbGRDb25maWc/LmZ1bmN0aW9uQ29uZmlnPy5jb250ZW50O1xyXG4gICAgICBpZihlbWJlZFR5cGUpe1xyXG4gICAgICAgIG9sZENvbmZpZyA9IG9sZENvbmZpZy5zZXQoJ2VtYmVkVHlwZScsIGVtYmVkVHlwZSk7XHJcbiAgICAgICAgaWYoZW1iZWRUeXBlID09PSBFbWJlZFR5cGUuVXJsKXtcclxuICAgICAgICAgIG9sZENvbmZpZyA9IG9sZENvbmZpZy5zZXQoJ3N0YXRpY1VybCcsIGNvbnRlbnQpO1xyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgIG9sZENvbmZpZyA9IG9sZENvbmZpZy5zZXQoJ2VtYmVkQ29kZScsIGNvbnRlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfWVsc2Uge1xyXG4gICAgICAgIG9sZENvbmZpZyA9IG9sZENvbmZpZy5zZXQoJ2VtYmVkVHlwZScsIEVtYmVkVHlwZS5VcmwpXHJcbiAgICAgIH1cclxuICAgICAgb2xkQ29uZmlnID0gb2xkQ29uZmlnLndpdGhvdXQoJ2Z1bmN0aW9uQ29uZmlnJylcclxuICAgICAgcmV0dXJuIG9sZENvbmZpZ1xyXG4gICAgfVxyXG4gIH1dXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB2ZXJzaW9uTWFuYWdlciA9IG5ldyBWZXJzaW9uTWFuYWdlcigpOyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUVBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./your-extensions/widgets/embed-download/src/embed-version-manager.ts\n");

/***/ }),

/***/ "./your-extensions/widgets/embed-download/src/runtime/assets/icon.svg":
/*!****************************************************************************!*\
  !*** ./your-extensions/widgets/embed-download/src/runtime/assets/icon.svg ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = \"<svg viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M2 1a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V2a1 1 0 00-1-1H2zm0-1h12a2 2 0 012 2v12a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2zM1 4h14v1H1V4zm1.5-1a.5.5 0 110-1 .5.5 0 010 1zm2 0a.5.5 0 110-1 .5.5 0 010 1zm2 0a.5.5 0 110-1 .5.5 0 010 1zm-.646 9.646a.5.5 0 11-.708.708l-3-3a.5.5 0 010-.708l3-3a.5.5 0 11.708.708L3.207 10l2.647 2.646zm4.292 0L12.793 10l-2.647-2.646a.5.5 0 11.708-.708l3 3a.5.5 0 010 .708l-3 3a.5.5 0 11-.708-.708zM8.982 6.62a.5.5 0 01.354.613l-1.553 5.795a.5.5 0 11-.966-.259L8.37 6.973a.5.5 0 01.612-.354z\\\" fill=\\\"#000\\\" fill-rule=\\\"nonzero\\\"></path></svg>\"//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvcnVudGltZS9hc3NldHMvaWNvbi5zdmcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvcnVudGltZS9hc3NldHMvaWNvbi5zdmc/OTYxOSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB2aWV3Qm94PVxcXCIwIDAgMTYgMTZcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCI+PHBhdGggZD1cXFwiTTIgMWExIDEgMCAwMC0xIDF2MTJhMSAxIDAgMDAxIDFoMTJhMSAxIDAgMDAxLTFWMmExIDEgMCAwMC0xLTFIMnptMC0xaDEyYTIgMiAwIDAxMiAydjEyYTIgMiAwIDAxLTIgMkgyYTIgMiAwIDAxLTItMlYyYTIgMiAwIDAxMi0yek0xIDRoMTR2MUgxVjR6bTEuNS0xYS41LjUgMCAxMTAtMSAuNS41IDAgMDEwIDF6bTIgMGEuNS41IDAgMTEwLTEgLjUuNSAwIDAxMCAxem0yIDBhLjUuNSAwIDExMC0xIC41LjUgMCAwMTAgMXptLS42NDYgOS42NDZhLjUuNSAwIDExLS43MDguNzA4bC0zLTNhLjUuNSAwIDAxMC0uNzA4bDMtM2EuNS41IDAgMTEuNzA4LjcwOEwzLjIwNyAxMGwyLjY0NyAyLjY0NnptNC4yOTIgMEwxMi43OTMgMTBsLTIuNjQ3LTIuNjQ2YS41LjUgMCAxMS43MDgtLjcwOGwzIDNhLjUuNSAwIDAxMCAuNzA4bC0zIDNhLjUuNSAwIDExLS43MDgtLjcwOHpNOC45ODIgNi42MmEuNS41IDAgMDEuMzU0LjYxM2wtMS41NTMgNS43OTVhLjUuNSAwIDExLS45NjYtLjI1OUw4LjM3IDYuOTczYS41LjUgMCAwMS42MTItLjM1NHpcXFwiIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwibm9uemVyb1xcXCI+PC9wYXRoPjwvc3ZnPlwiIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./your-extensions/widgets/embed-download/src/runtime/assets/icon.svg\n");

/***/ }),

/***/ "./your-extensions/widgets/embed-download/src/runtime/translations/default.ts":
/*!************************************************************************************!*\
  !*** ./your-extensions/widgets/embed-download/src/runtime/translations/default.ts ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    _widgetLabel: 'Embed',\r\n    embedHint: 'Embed by URL or code',\r\n    unSupportUrl: 'It\\'s not a valid URL.',\r\n    unSupportIframeUrl: 'Sorry, this content could not be embedded. It may restrict the embedding of content from other sites.'\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvcnVudGltZS90cmFuc2xhdGlvbnMvZGVmYXVsdC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3lvdXItZXh0ZW5zaW9ucy93aWRnZXRzL2VtYmVkLWRvd25sb2FkL3NyYy9ydW50aW1lL3RyYW5zbGF0aW9ucy9kZWZhdWx0LnRzPzM5OWQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQge1xyXG4gIF93aWRnZXRMYWJlbDogJ0VtYmVkJyxcclxuICBlbWJlZEhpbnQ6ICdFbWJlZCBieSBVUkwgb3IgY29kZScsXHJcbiAgdW5TdXBwb3J0VXJsOiAnSXRcXCdzIG5vdCBhIHZhbGlkIFVSTC4nLFxyXG4gIHVuU3VwcG9ydElmcmFtZVVybDogJ1NvcnJ5LCB0aGlzIGNvbnRlbnQgY291bGQgbm90IGJlIGVtYmVkZGVkLiBJdCBtYXkgcmVzdHJpY3QgdGhlIGVtYmVkZGluZyBvZiBjb250ZW50IGZyb20gb3RoZXIgc2l0ZXMuJ1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./your-extensions/widgets/embed-download/src/runtime/translations/default.ts\n");

/***/ }),

/***/ "./your-extensions/widgets/embed-download/src/runtime/widget.tsx":
/*!***********************************************************************!*\
  !*** ./your-extensions/widgets/embed-download/src/runtime/widget.tsx ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar jimu_core_1 = __webpack_require__(/*! jimu-core */ \"jimu-core\");\r\nvar jimu_ui_1 = __webpack_require__(/*! jimu-ui */ \"jimu-ui\");\r\nvar config_1 = __webpack_require__(/*! ../config */ \"./your-extensions/widgets/embed-download/src/config.ts\");\r\nvar default_1 = __importDefault(__webpack_require__(/*! ./translations/default */ \"./your-extensions/widgets/embed-download/src/runtime/translations/default.ts\"));\r\nvar embed_version_manager_1 = __webpack_require__(/*! ../embed-version-manager */ \"./your-extensions/widgets/embed-download/src/embed-version-manager.ts\");\r\nvar Widget = /** @class */ (function (_super) {\r\n    __extends(Widget, _super);\r\n    function Widget(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.iframeOnLoad = function (evt) {\r\n            // if(this.loadTimeOut){\r\n            //   clearTimeout(this.loadTimeOut);\r\n            //   this.loadTimeOut = undefined;\r\n            // }\r\n            var state = {\r\n                isResetting: false\r\n            };\r\n            _this.setState(state);\r\n        };\r\n        _this.processUrl = function (url) {\r\n            var _a;\r\n            if (!url)\r\n                return url;\r\n            //support Google Map, Youtube Facebook Vimeo now.\r\n            var lowerUrl = url.toLowerCase();\r\n            /**\r\n             * support Google Map\r\n             */\r\n            // if(lowerUrl.indexOf('https://www.google.com/maps') > -1 || lowerUrl.indexOf('https://goo.gl/maps') > -1){//google map\r\n            //   return url;\r\n            // }\r\n            /**\r\n             * Vimeo\r\n             */\r\n            if (/https:\\/\\/vimeo\\.com\\/.*/.test(lowerUrl)) {\r\n                url = jimu_core_1.urlUtils.removeSearchFromUrl(url);\r\n                var splits = url.split('/');\r\n                var id = splits[splits.length - 1];\r\n                return \"https://player.vimeo.com/video/\" + id;\r\n            }\r\n            /**\r\n             * Youtube\r\n             */\r\n            if (/https:\\/\\/www\\.youtube\\.com\\/watch\\?.*v=.*/.test(lowerUrl)) {\r\n                var queryObj = (_a = jimu_core_1.queryString.parseUrl(url)) === null || _a === void 0 ? void 0 : _a.query;\r\n                var id = queryObj === null || queryObj === void 0 ? void 0 : queryObj['v'];\r\n                return \"https://www.youtube.com/embed/\" + id;\r\n            }\r\n            else if (/https:\\/\\/youtu\\.be\\/.*/.test(lowerUrl)) {\r\n                url = jimu_core_1.urlUtils.removeSearchFromUrl(url);\r\n                var splits = url.split('/');\r\n                var id = splits[splits.length - 1];\r\n                return \"https://www.youtube.com/embed/\" + id;\r\n            }\r\n            /**\r\n             * Facebook video\r\n             */\r\n            if (/https:\\/\\/www\\.facebook\\.com\\/.*\\/videos\\/.*/.test(lowerUrl)) {\r\n                return \"https://www.facebook.com/plugins/video.php?href=\" + lowerUrl + \"&show_text=0\";\r\n            }\r\n            if (!_this.checkURLFormat(url)) {\r\n                url = 'about:blank';\r\n            }\r\n            else {\r\n                url = jimu_core_1.urlUtils.appendQueryParam(url, \"rand_\" + new Date().getTime(), \"\" + new Date().getTime());\r\n            }\r\n            return url;\r\n        };\r\n        _this.checkURLFormat = function (str) {\r\n            if (!str || str === '')\r\n                return false;\r\n            var httpsRex = '^(([h][t]{2}[p][s])?://)';\r\n            var re = new RegExp(httpsRex);\r\n            if (!re.test(str)) {\r\n                return false;\r\n            }\r\n            var index = str.indexOf('.');\r\n            if (index < 0 || index === str.length - 1) {\r\n                return false;\r\n            }\r\n            return true;\r\n        };\r\n        _this.formatMessage = function (id) {\r\n            return _this.props.intl.formatMessage({ id: id, defaultMessage: default_1.default[id] });\r\n        };\r\n        _this.fetchUrl = function (url) { return __awaiter(_this, void 0, Promise, function () {\r\n            var headers, result, json;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        headers = {\r\n                            'Access-Control-Allow-Origin': '*',\r\n                            'Content-Type': 'text/json'\r\n                        };\r\n                        return [4 /*yield*/, fetch(url, {\r\n                                method: 'get',\r\n                                headers: headers,\r\n                            }).catch(function (err) { })];\r\n                    case 1:\r\n                        result = _a.sent();\r\n                        if (!result)\r\n                            return [2 /*return*/, Promise.resolve(null)];\r\n                        return [4 /*yield*/, result.json().catch(function (error) { })];\r\n                    case 2:\r\n                        json = _a.sent();\r\n                        return [2 /*return*/, Promise.resolve(json)];\r\n                }\r\n            });\r\n        }); };\r\n        _this.isUsedDataSource = function (props) {\r\n            if (!props) {\r\n                props = _this.props;\r\n            }\r\n            var useDataSources = props.useDataSources, useDataSourcesEnabled = props.useDataSourcesEnabled;\r\n            return useDataSourcesEnabled && useDataSources && useDataSources.length > 0;\r\n        };\r\n        _this.onUrlExpResolveChange = function (result) {\r\n            if (result === null || result === void 0 ? void 0 : result.isSuccessful) {\r\n                _this.setState({\r\n                    content: result.value,\r\n                    resolveErr: false\r\n                });\r\n            }\r\n            else {\r\n                _this.setState({\r\n                    resolveErr: true\r\n                });\r\n            }\r\n        };\r\n        _this.getRecordsFromRepeatedDataSource = function () {\r\n            var _a;\r\n            var dataSourceId = _this.props.useDataSources && _this.props.useDataSources[0] && _this.props.useDataSources[0].dataSourceId;\r\n            if (dataSourceId && _this.props.repeatedDataSource) {\r\n                if (dataSourceId === _this.props.repeatedDataSource.dataSourceId) {\r\n                    var record = _this.props.repeatedDataSource.record;\r\n                    return _a = {},\r\n                        _a[dataSourceId] = record,\r\n                        _a;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        _this.onResize = function (width, height) {\r\n            if (_this.size) {\r\n                var _a = _this.size, oldWidth = _a.width, oldHeight = _a.height;\r\n                if ((oldWidth < 1 || oldHeight < 1) && (width > 1 && height > 1)) {\r\n                    if (_this.needReload) {\r\n                        _this.reload();\r\n                        _this.needReload = false;\r\n                    }\r\n                }\r\n            }\r\n            _this.size = {\r\n                width: width,\r\n                height: height\r\n            };\r\n        };\r\n        _this.reload = function () {\r\n            var config = _this.props.config;\r\n            if (_this.ifr) {\r\n                if (config.embedType === config_1.EmbedType.Code) { //code\r\n                    var srcDoc = _this.ifr.srcdoc;\r\n                    _this.ifr.srcdoc = srcDoc;\r\n                }\r\n                else {\r\n                    var src = _this.ifr.src;\r\n                    _this.ifr.src = src;\r\n                }\r\n            }\r\n        };\r\n        _this.loadContent = function () {\r\n            var config = _this.props.config;\r\n            var content = _this.state.content;\r\n            var embedType = config.embedType;\r\n            if (_this.ifr) {\r\n                if (embedType === config_1.EmbedType.Code) { //code\r\n                    _this.ifr.srcdoc = content;\r\n                }\r\n                else {\r\n                    _this.ifr.src = _this.processUrl(content);\r\n                }\r\n            }\r\n        };\r\n        var config = props.config;\r\n        var embedType = config.embedType, embedCode = config.embedCode;\r\n        _this.errMessages = {\r\n            unSupportUrl: _this.formatMessage('unSupportUrl'),\r\n            unSupportIframeUrl: _this.formatMessage('unSupportIframeUrl'),\r\n        };\r\n        _this.checkUrl = _this.checkUrl.bind(_this);\r\n        var state = {\r\n            content: embedType === config_1.EmbedType.Url ? (_this.isUsedDataSource() ? undefined : config.staticUrl) : embedCode,\r\n            loadErr: false,\r\n            resolveErr: false\r\n        };\r\n        _this.state = state;\r\n        return _this;\r\n    }\r\n    Widget.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        var config = this.props.config;\r\n        var content = this.state.content;\r\n        if (content && content.trim().length > 0) {\r\n            this.setState({\r\n                isResetting: true\r\n            }, function () {\r\n                _this.loadContent();\r\n                if (config.embedType === config_1.EmbedType.Url) {\r\n                    _this.checkUrl(_this.processUrl(content));\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Widget.prototype.componentDidUpdate = function (preProps, preStates) {\r\n        var _this = this;\r\n        var appMode = this.props.appMode;\r\n        if (appMode !== preProps.appMode && appMode === jimu_core_1.AppMode.Design) {\r\n            this.reload();\r\n        }\r\n        var _a = this.props.config, embedCode = _a.embedCode, embedType = _a.embedType, staticUrl = _a.staticUrl;\r\n        if (embedType !== preProps.config.embedType) {\r\n            var content_1 = embedType === config_1.EmbedType.Url ? (this.isUsedDataSource() ? undefined : staticUrl) : embedCode;\r\n            this.setState({\r\n                content: content_1\r\n            });\r\n        }\r\n        else {\r\n            if (embedType === config_1.EmbedType.Url) {\r\n                var nowUsedDataSource = this.isUsedDataSource();\r\n                var preUsedDataSource = this.isUsedDataSource(preProps);\r\n                //if usedDataSource, the content will be changed by expression resolver component\r\n                if (!nowUsedDataSource || nowUsedDataSource !== preUsedDataSource) {\r\n                    var content_2 = nowUsedDataSource ? undefined : staticUrl;\r\n                    this.setState({\r\n                        content: content_2\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (preProps.config.embedCode !== embedCode) {\r\n                    this.setState({\r\n                        content: embedCode\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        var content = this.state.content;\r\n        var oldContent = preStates.content;\r\n        if (content !== oldContent) {\r\n            this.setState({\r\n                isResetting: !!content,\r\n                loadErr: false\r\n            }, function () {\r\n                _this.loadContent();\r\n                if (embedType === config_1.EmbedType.Url) {\r\n                    _this.checkUrl(_this.processUrl(content));\r\n                    if (_this.size) {\r\n                        var _a = _this.size, width = _a.width, height = _a.height;\r\n                        if (width < 1 || height < 1) { //for display:none in view in section\r\n                            _this.needReload = true;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Widget.prototype.checkUrl = function (url) {\r\n        var _this = this;\r\n        var _a, _b, _c;\r\n        if (!this.checkURLFormat(url)) {\r\n            this.setState({\r\n                loadErr: true,\r\n                errMessage: this.errMessages.unSupportUrl\r\n            });\r\n            return;\r\n        }\r\n        var appMode = (_c = (_b = (_a = jimu_core_1.getAppStore()) === null || _a === void 0 ? void 0 : _a.getState()) === null || _b === void 0 ? void 0 : _b.appRuntimeInfo) === null || _c === void 0 ? void 0 : _c.appMode;\r\n        if (!url || !window.jimuConfig.isInBuilder || appMode === jimu_core_1.AppMode.Run || window.jimuConfig.isInPortal)\r\n            return;\r\n        if (url.indexOf('https://www.facebook.com/plugins/video.php?show_text=0&href=') > -1 ||\r\n            url.indexOf('https://www.youtube.com/embed/') > -1 ||\r\n            url.indexOf('https://player.vimeo.com/video/') > -1) {\r\n            this.setState({\r\n                loadErr: false\r\n            });\r\n            return;\r\n        }\r\n        this.fetchUrl(window.location.origin + \"/check_url?url=\" + url).then(function (res) {\r\n            var _a, _b, _c;\r\n            var canLoadUrl = true;\r\n            if (res && res.success) {\r\n                var data = res.data;\r\n                var status = data === null || data === void 0 ? void 0 : data.status;\r\n                if (status && status < 400) {\r\n                    var contentSecurityPolicy = (_a = data === null || data === void 0 ? void 0 : data.headers) === null || _a === void 0 ? void 0 : _a['content-security-policy'];\r\n                    if (contentSecurityPolicy) {\r\n                        canLoadUrl = false;\r\n                    }\r\n                    var xFrameOptions = (_c = (_b = data === null || data === void 0 ? void 0 : data.headers) === null || _b === void 0 ? void 0 : _b['x-frame-options']) === null || _c === void 0 ? void 0 : _c.toLowerCase();\r\n                    if (xFrameOptions) {\r\n                        if (xFrameOptions === 'deny') {\r\n                            canLoadUrl = false;\r\n                        }\r\n                        else if (xFrameOptions === 'sameorigin') {\r\n                            if (!_this.isOriginSameAsLocation(url)) {\r\n                                canLoadUrl = false;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    canLoadUrl = false;\r\n                }\r\n            }\r\n            else {\r\n                canLoadUrl = false;\r\n            }\r\n            var alterState = {\r\n                loadErr: !canLoadUrl\r\n            };\r\n            if (!canLoadUrl) {\r\n                alterState.isResetting = false;\r\n                alterState.errMessage = _this.errMessages.unSupportIframeUrl;\r\n            }\r\n            _this.setState(alterState);\r\n        });\r\n    };\r\n    Widget.prototype.isOriginSameAsLocation = function (url) {\r\n        var pageLocation = window.location;\r\n        var URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\r\n        var urlMatch = URL_HOST_PATTERN.exec(url) || [];\r\n        var urlparts = {\r\n            protocol: urlMatch[1] || '',\r\n            host: urlMatch[2] || '',\r\n            port: urlMatch[3] || ''\r\n        };\r\n        var defaultPort = function (protocol) {\r\n            return { 'http:': 80, 'https:': 443 }[protocol];\r\n        };\r\n        var portOf = function (location) {\r\n            return location.port || defaultPort(location.protocol || pageLocation.protocol);\r\n        };\r\n        return !!((urlparts.protocol && (urlparts.protocol == pageLocation.protocol)) &&\r\n            (urlparts.host && (urlparts.host == pageLocation.host)) &&\r\n            (urlparts.host && (portOf(urlparts) == portOf(pageLocation))));\r\n    };\r\n    Widget.prototype.render = function () {\r\n        var _this = this;\r\n        var _a = this.state, isResetting = _a.isResetting, loadErr = _a.loadErr, errMessage = _a.errMessage, resolveErr = _a.resolveErr;\r\n        var _b = this.props, theme = _b.theme, id = _b.id, config = _b.config;\r\n        var embedCode = config.embedCode, embedType = config.embedType, staticUrl = config.staticUrl, expression = config.expression;\r\n        var isDataSourceUsed = this.props.useDataSourcesEnabled;\r\n        var showPlaceholder = embedType === config_1.EmbedType.Code ? !embedCode :\r\n            ((!staticUrl && !isDataSourceUsed) || (isDataSourceUsed && !expression));\r\n        if (showPlaceholder) {\r\n            return jimu_core_1.React.createElement(jimu_ui_1.WidgetPlaceholder, { widgetId: this.props.id, icon: __webpack_require__(/*! ./assets/icon.svg */ \"./your-extensions/widgets/embed-download/src/runtime/assets/icon.svg\"), message: this.formatMessage('embedHint') });\r\n        }\r\n        return (jimu_core_1.React.createElement(\"div\", { style: { width: '100%', height: '100%', position: 'relative' }, className: \"jimu-widget widget-embed\" },\r\n            jimu_core_1.React.createElement(\"iframe\", { className: \"iframe-\" + id, style: { width: '100%', height: '100%' }, sandbox: \"allow-scripts allow-same-origin allow-forms allow-popups allow-presentation allow-popups-to-escape-sandbox allow-downloads\", allowFullScreen: true, onLoad: this.iframeOnLoad, frameBorder: \"0\", ref: function (f) { _this.ifr = f; } }),\r\n            isResetting && jimu_core_1.React.createElement(\"div\", { className: \"jimu-secondary-loading\" }),\r\n            loadErr &&\r\n                jimu_core_1.React.createElement(\"div\", { className: \"mask text-center\", style: {\r\n                        position: 'absolute',\r\n                        left: 0,\r\n                        right: 0,\r\n                        top: 0,\r\n                        bottom: 0,\r\n                        paddingTop: '30%',\r\n                        backgroundColor: theme.colors.white\r\n                    } }, errMessage),\r\n            resolveErr && isDataSourceUsed &&\r\n                jimu_core_1.React.createElement(\"div\", { className: \"mask text-center\", style: {\r\n                        position: 'absolute',\r\n                        left: 0,\r\n                        right: 0,\r\n                        top: 0,\r\n                        bottom: 0,\r\n                        paddingTop: '30%',\r\n                        backgroundColor: theme.colors.white\r\n                    } }, expression === null || expression === void 0 ? void 0 : expression.name),\r\n            jimu_core_1.React.createElement(\"div\", { style: { display: 'none' } }, isDataSourceUsed && embedType === config_1.EmbedType.Url && expression &&\r\n                jimu_core_1.React.createElement(\"div\", null,\r\n                    jimu_core_1.React.createElement(jimu_core_1.ExpressionResolverComponent, { useDataSources: this.props.useDataSources, expression: expression, onChange: this.onUrlExpResolveChange, widgetId: this.props.id }))),\r\n            jimu_core_1.React.createElement(jimu_core_1.ReactResizeDetector, { handleWidth: true, handleHeight: true, onResize: this.onResize })));\r\n    };\r\n    Widget.versionManager = embed_version_manager_1.versionManager;\r\n    Widget.mapExtraStateProps = function (state, props) {\r\n        var _a;\r\n        return {\r\n            appMode: (_a = state === null || state === void 0 ? void 0 : state.appRuntimeInfo) === null || _a === void 0 ? void 0 : _a.appMode,\r\n        };\r\n    };\r\n    return Widget;\r\n}(jimu_core_1.BaseWidget));\r\nexports.default = Widget;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi95b3VyLWV4dGVuc2lvbnMvd2lkZ2V0cy9lbWJlZC1kb3dubG9hZC9zcmMvcnVudGltZS93aWRnZXQudHN4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4veW91ci1leHRlbnNpb25zL3dpZGdldHMvZW1iZWQtZG93bmxvYWQvc3JjL3J1bnRpbWUvd2lkZ2V0LnRzeD9lMzJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgUmVhY3QsIEJhc2VXaWRnZXQsIEFsbFdpZGdldFByb3BzLFxyXG4gIEV4cHJlc3Npb25SZXNvbHZlckNvbXBvbmVudCwgRGF0YVJlY29yZCwgUmVwZWF0ZWREYXRhU291cmNlLCBnZXRBcHBTdG9yZSwgQXBwTW9kZSwgdXJsVXRpbHMsIHF1ZXJ5U3RyaW5nLCBJTVN0YXRlLCBSZWFjdFJlc2l6ZURldGVjdG9yXHJcbn0gZnJvbSAnamltdS1jb3JlJztcclxuaW1wb3J0IHsgV2lkZ2V0UGxhY2Vob2xkZXIgfSBmcm9tICdqaW11LXVpJztcclxuaW1wb3J0IHsgSU1Db25maWcsIEVtYmVkVHlwZSB9IGZyb20gJy4uL2NvbmZpZyc7XHJcbmltcG9ydCBkZWZhdWx0TWVzc2FnZXMgZnJvbSAnLi90cmFuc2xhdGlvbnMvZGVmYXVsdCc7XHJcbmltcG9ydCB7IHZlcnNpb25NYW5hZ2VyIH0gZnJvbSAnLi4vZW1iZWQtdmVyc2lvbi1tYW5hZ2VyJztcclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgY29udGVudD86IHN0cmluZztcclxuICBpc1Jlc2V0dGluZz86IGJvb2xlYW47XHJcbiAgbG9hZEVycj86IGJvb2xlYW47XHJcbiAgZXJyTWVzc2FnZT86IHN0cmluZztcclxuICByZXNvbHZlRXJyPzogYm9vbGVhblxyXG59XHJcblxyXG5pbnRlcmZhY2UgUHJvcHN7XHJcbiAgYXBwTW9kZTogQXBwTW9kZSxcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2lkZ2V0IGV4dGVuZHMgQmFzZVdpZGdldDxBbGxXaWRnZXRQcm9wczxJTUNvbmZpZz4gJiBQcm9wcywgU3RhdGU+e1xyXG4gIHN0YXRpYyB2ZXJzaW9uTWFuYWdlciA9IHZlcnNpb25NYW5hZ2VyO1xyXG4gIGlmcjogSFRNTElGcmFtZUVsZW1lbnQ7XHJcbiAgbmVlZFJlbG9hZDogYm9vbGVhbjtcclxuICBzaXplOiB7XHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXJcclxuICB9XHJcbiAgZXJyTWVzc2FnZXM6IHtcclxuICAgIHVuU3VwcG9ydFVybDogc3RyaW5nLFxyXG4gICAgdW5TdXBwb3J0SWZyYW1lVXJsOiBzdHJpbmcsXHJcbiAgfVxyXG5cclxuICBzdGF0aWMgbWFwRXh0cmFTdGF0ZVByb3BzID0gKHN0YXRlOiBJTVN0YXRlLCBwcm9wczogQWxsV2lkZ2V0UHJvcHM8SU1Db25maWc+KTogUHJvcHMgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXBwTW9kZTogc3RhdGU/LmFwcFJ1bnRpbWVJbmZvPy5hcHBNb2RlLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIGNvbnN0IHsgY29uZmlnIH0gPSBwcm9wcztcclxuICAgIGNvbnN0IHsgZW1iZWRUeXBlLCBlbWJlZENvZGUgfSA9IGNvbmZpZztcclxuXHJcbiAgICB0aGlzLmVyck1lc3NhZ2VzID0ge1xyXG4gICAgICB1blN1cHBvcnRVcmw6IHRoaXMuZm9ybWF0TWVzc2FnZSgndW5TdXBwb3J0VXJsJyksXHJcbiAgICAgIHVuU3VwcG9ydElmcmFtZVVybDogdGhpcy5mb3JtYXRNZXNzYWdlKCd1blN1cHBvcnRJZnJhbWVVcmwnKSxcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNoZWNrVXJsID0gdGhpcy5jaGVja1VybC5iaW5kKHRoaXMpO1xyXG4gICAgY29uc3Qgc3RhdGU6IFN0YXRlID0ge1xyXG4gICAgICBjb250ZW50OiBlbWJlZFR5cGUgPT09IEVtYmVkVHlwZS5VcmwgPyAodGhpcy5pc1VzZWREYXRhU291cmNlKCkgPyB1bmRlZmluZWQgOiBjb25maWcuc3RhdGljVXJsKSA6IGVtYmVkQ29kZSxcclxuICAgICAgbG9hZEVycjogZmFsc2UsXHJcbiAgICAgIHJlc29sdmVFcnI6IGZhbHNlXHJcbiAgICB9O1xyXG4gICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICBjb25zdCB7IGNvbmZpZyB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHsgY29udGVudCB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQudHJpbSgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgaXNSZXNldHRpbmc6IHRydWVcclxuICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMubG9hZENvbnRlbnQoKTtcclxuICAgICAgICBpZihjb25maWcuZW1iZWRUeXBlID09PSBFbWJlZFR5cGUuVXJsKXtcclxuICAgICAgICAgIHRoaXMuY2hlY2tVcmwodGhpcy5wcm9jZXNzVXJsKGNvbnRlbnQpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZVByb3BzLCBwcmVTdGF0ZXMpIHtcclxuICAgIGNvbnN0IHthcHBNb2RlfSA9IHRoaXMucHJvcHM7XHJcbiAgICBpZihhcHBNb2RlICE9PSBwcmVQcm9wcy5hcHBNb2RlICYmIGFwcE1vZGUgPT09IEFwcE1vZGUuRGVzaWduKXtcclxuICAgICAgdGhpcy5yZWxvYWQoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgZW1iZWRDb2RlLCBlbWJlZFR5cGUsIHN0YXRpY1VybCB9ID0gdGhpcy5wcm9wcy5jb25maWc7XHJcbiAgICBpZiAoZW1iZWRUeXBlICE9PSBwcmVQcm9wcy5jb25maWcuZW1iZWRUeXBlKSB7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBlbWJlZFR5cGUgPT09IEVtYmVkVHlwZS5VcmwgPyAodGhpcy5pc1VzZWREYXRhU291cmNlKCkgPyB1bmRlZmluZWQgOiBzdGF0aWNVcmwpIDogZW1iZWRDb2RlO1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBjb250ZW50OiBjb250ZW50XHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoZW1iZWRUeXBlID09PSBFbWJlZFR5cGUuVXJsKSB7XHJcbiAgICAgICAgY29uc3Qgbm93VXNlZERhdGFTb3VyY2UgPSB0aGlzLmlzVXNlZERhdGFTb3VyY2UoKVxyXG4gICAgICAgIGNvbnN0IHByZVVzZWREYXRhU291cmNlID0gdGhpcy5pc1VzZWREYXRhU291cmNlKHByZVByb3BzKVxyXG4gICAgICAgIC8vaWYgdXNlZERhdGFTb3VyY2UsIHRoZSBjb250ZW50IHdpbGwgYmUgY2hhbmdlZCBieSBleHByZXNzaW9uIHJlc29sdmVyIGNvbXBvbmVudFxyXG4gICAgICAgIGlmICghbm93VXNlZERhdGFTb3VyY2UgfHwgbm93VXNlZERhdGFTb3VyY2UgIT09IHByZVVzZWREYXRhU291cmNlKSB7XHJcbiAgICAgICAgICBjb25zdCBjb250ZW50ID0gbm93VXNlZERhdGFTb3VyY2UgPyB1bmRlZmluZWQgOiBzdGF0aWNVcmw7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgY29udGVudDogY29udGVudFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHByZVByb3BzLmNvbmZpZy5lbWJlZENvZGUgIT09IGVtYmVkQ29kZSkge1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGVtYmVkQ29kZVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgY29uc3QgeyBjb250ZW50IH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgeyBjb250ZW50OiBvbGRDb250ZW50IH0gPSBwcmVTdGF0ZXM7XHJcbiAgICBpZiAoY29udGVudCAhPT0gb2xkQ29udGVudCkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBpc1Jlc2V0dGluZzogISFjb250ZW50LFxyXG4gICAgICAgIGxvYWRFcnI6IGZhbHNlXHJcbiAgICAgIH0sICgpID0+IHtcclxuICAgICAgICB0aGlzLmxvYWRDb250ZW50KClcclxuICAgICAgICBpZihlbWJlZFR5cGUgPT09IEVtYmVkVHlwZS5Vcmwpe1xyXG4gICAgICAgICAgdGhpcy5jaGVja1VybCh0aGlzLnByb2Nlc3NVcmwoY29udGVudCkpO1xyXG4gICAgICAgICAgaWYodGhpcy5zaXplKXtcclxuICAgICAgICAgICAgY29uc3Qge3dpZHRoLCBoZWlnaHR9ID0gdGhpcy5zaXplXHJcbiAgICAgICAgICAgIGlmKHdpZHRoIDwgMSB8fCBoZWlnaHQgPCAxKXsvL2ZvciBkaXNwbGF5Om5vbmUgaW4gdmlldyBpbiBzZWN0aW9uXHJcbiAgICAgICAgICAgICAgdGhpcy5uZWVkUmVsb2FkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpZnJhbWVPbkxvYWQgPSAoZXZ0KSA9PiB7XHJcbiAgICAvLyBpZih0aGlzLmxvYWRUaW1lT3V0KXtcclxuICAgIC8vICAgY2xlYXJUaW1lb3V0KHRoaXMubG9hZFRpbWVPdXQpO1xyXG4gICAgLy8gICB0aGlzLmxvYWRUaW1lT3V0ID0gdW5kZWZpbmVkO1xyXG4gICAgLy8gfVxyXG4gICAgY29uc3Qgc3RhdGU6IFN0YXRlID0ge1xyXG4gICAgICBpc1Jlc2V0dGluZzogZmFsc2VcclxuICAgIH1cclxuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpXHJcbiAgfVxyXG5cclxuICBwcm9jZXNzVXJsID0gKHVybDogc3RyaW5nKTogc3RyaW5nID0+IHtcclxuICAgIGlmICghdXJsKSByZXR1cm4gdXJsO1xyXG4gICAgLy9zdXBwb3J0IEdvb2dsZSBNYXAsIFlvdXR1YmUgRmFjZWJvb2sgVmltZW8gbm93LlxyXG4gICAgY29uc3QgbG93ZXJVcmwgPSB1cmwudG9Mb3dlckNhc2UoKTtcclxuICAgIC8qKlxyXG4gICAgICogc3VwcG9ydCBHb29nbGUgTWFwXHJcbiAgICAgKi9cclxuICAgIC8vIGlmKGxvd2VyVXJsLmluZGV4T2YoJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcycpID4gLTEgfHwgbG93ZXJVcmwuaW5kZXhPZignaHR0cHM6Ly9nb28uZ2wvbWFwcycpID4gLTEpey8vZ29vZ2xlIG1hcFxyXG4gICAgLy8gICByZXR1cm4gdXJsO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmltZW9cclxuICAgICAqL1xyXG4gICAgaWYgKC9odHRwczpcXC9cXC92aW1lb1xcLmNvbVxcLy4qLy50ZXN0KGxvd2VyVXJsKSkge1xyXG4gICAgICB1cmwgPSB1cmxVdGlscy5yZW1vdmVTZWFyY2hGcm9tVXJsKHVybClcclxuICAgICAgY29uc3Qgc3BsaXRzID0gdXJsLnNwbGl0KCcvJyk7XHJcbiAgICAgIGNvbnN0IGlkID0gc3BsaXRzW3NwbGl0cy5sZW5ndGggLSAxXTtcclxuICAgICAgcmV0dXJuIGBodHRwczovL3BsYXllci52aW1lby5jb20vdmlkZW8vJHtpZH1gO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogWW91dHViZVxyXG4gICAgICovXHJcbiAgICBpZiAoL2h0dHBzOlxcL1xcL3d3d1xcLnlvdXR1YmVcXC5jb21cXC93YXRjaFxcPy4qdj0uKi8udGVzdChsb3dlclVybCkpIHtcclxuICAgICAgY29uc3QgcXVlcnlPYmogPSBxdWVyeVN0cmluZy5wYXJzZVVybCh1cmwpPy5xdWVyeVxyXG4gICAgICBjb25zdCBpZCA9IHF1ZXJ5T2JqPy5bJ3YnXTtcclxuICAgICAgcmV0dXJuIGBodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8ke2lkfWBcclxuICAgIH0gZWxzZSBpZiAoL2h0dHBzOlxcL1xcL3lvdXR1XFwuYmVcXC8uKi8udGVzdChsb3dlclVybCkpIHtcclxuICAgICAgdXJsID0gdXJsVXRpbHMucmVtb3ZlU2VhcmNoRnJvbVVybCh1cmwpXHJcbiAgICAgIGNvbnN0IHNwbGl0cyA9IHVybC5zcGxpdCgnLycpO1xyXG4gICAgICBjb25zdCBpZCA9IHNwbGl0c1tzcGxpdHMubGVuZ3RoIC0gMV07XHJcbiAgICAgIHJldHVybiBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvJHtpZH1gXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGYWNlYm9vayB2aWRlb1xyXG4gICAgICovXHJcbiAgICBpZiAoL2h0dHBzOlxcL1xcL3d3d1xcLmZhY2Vib29rXFwuY29tXFwvLipcXC92aWRlb3NcXC8uKi8udGVzdChsb3dlclVybCkpIHtcclxuICAgICAgcmV0dXJuIGBodHRwczovL3d3dy5mYWNlYm9vay5jb20vcGx1Z2lucy92aWRlby5waHA/aHJlZj0ke2xvd2VyVXJsfSZzaG93X3RleHQ9MGBcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXRoaXMuY2hlY2tVUkxGb3JtYXQodXJsKSkge1xyXG4gICAgICB1cmwgPSAnYWJvdXQ6YmxhbmsnXHJcbiAgICB9ZWxzZXtcclxuICAgICAgdXJsID0gdXJsVXRpbHMuYXBwZW5kUXVlcnlQYXJhbSh1cmwsIGByYW5kXyR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YCwgYCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YClcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdXJsO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tVUkxGb3JtYXQgPSAoc3RyOiBzdHJpbmcpOiBib29sZWFuID0+IHtcclxuICAgIGlmICghc3RyIHx8IHN0ciA9PT0gJycpIHJldHVybiBmYWxzZTtcclxuICAgIGNvbnN0IGh0dHBzUmV4ID0gJ14oKFtoXVt0XXsyfVtwXVtzXSk/Oi8vKSc7XHJcbiAgICBjb25zdCByZSA9IG5ldyBSZWdFeHAoaHR0cHNSZXgpO1xyXG4gICAgaWYgKCFyZS50ZXN0KHN0cikpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kZXggPSBzdHIuaW5kZXhPZignLicpO1xyXG4gICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA9PT0gc3RyLmxlbmd0aCAtIDEpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWVcclxuICB9XHJcblxyXG4gIGNoZWNrVXJsKHVybDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXRoaXMuY2hlY2tVUkxGb3JtYXQodXJsKSkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBsb2FkRXJyOiB0cnVlLFxyXG4gICAgICAgIGVyck1lc3NhZ2U6IHRoaXMuZXJyTWVzc2FnZXMudW5TdXBwb3J0VXJsXHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGFwcE1vZGUgPSBnZXRBcHBTdG9yZSgpPy5nZXRTdGF0ZSgpPy5hcHBSdW50aW1lSW5mbz8uYXBwTW9kZTtcclxuICAgIGlmICghdXJsIHx8ICF3aW5kb3cuamltdUNvbmZpZy5pc0luQnVpbGRlciB8fCBhcHBNb2RlID09PSBBcHBNb2RlLlJ1biB8fCB3aW5kb3cuamltdUNvbmZpZy5pc0luUG9ydGFsKSByZXR1cm47XHJcbiAgICBpZiAodXJsLmluZGV4T2YoJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9wbHVnaW5zL3ZpZGVvLnBocD9zaG93X3RleHQ9MCZocmVmPScpID4gLTEgfHxcclxuICAgICAgdXJsLmluZGV4T2YoJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkLycpID4gLTEgfHxcclxuICAgICAgdXJsLmluZGV4T2YoJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS92aWRlby8nKSA+IC0xKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGxvYWRFcnI6IGZhbHNlXHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgdGhpcy5mZXRjaFVybChgJHt3aW5kb3cubG9jYXRpb24ub3JpZ2lufS9jaGVja191cmw/dXJsPSR7dXJsfWApLnRoZW4ocmVzID0+IHtcclxuICAgICAgbGV0IGNhbkxvYWRVcmw6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgICBpZiAocmVzICYmIHJlcy5zdWNjZXNzKSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IGRhdGE/LnN0YXR1cztcclxuICAgICAgICBpZiAoc3RhdHVzICYmIHN0YXR1cyA8IDQwMCkge1xyXG4gICAgICAgICAgY29uc3QgY29udGVudFNlY3VyaXR5UG9saWN5ID0gZGF0YT8uaGVhZGVycz8uWydjb250ZW50LXNlY3VyaXR5LXBvbGljeSddO1xyXG4gICAgICAgICAgaWYgKGNvbnRlbnRTZWN1cml0eVBvbGljeSkge1xyXG4gICAgICAgICAgICBjYW5Mb2FkVXJsID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zdCB4RnJhbWVPcHRpb25zID0gZGF0YT8uaGVhZGVycz8uWyd4LWZyYW1lLW9wdGlvbnMnXT8udG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgIGlmICh4RnJhbWVPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGlmICh4RnJhbWVPcHRpb25zID09PSAnZGVueScpIHtcclxuICAgICAgICAgICAgICBjYW5Mb2FkVXJsID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeEZyYW1lT3B0aW9ucyA9PT0gJ3NhbWVvcmlnaW4nKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzT3JpZ2luU2FtZUFzTG9jYXRpb24odXJsKSkge1xyXG4gICAgICAgICAgICAgICAgY2FuTG9hZFVybCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjYW5Mb2FkVXJsID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbkxvYWRVcmwgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBhbHRlclN0YXRlOiBTdGF0ZSA9IHtcclxuICAgICAgICBsb2FkRXJyOiAhY2FuTG9hZFVybFxyXG4gICAgICB9XHJcbiAgICAgIGlmICghY2FuTG9hZFVybCkge1xyXG4gICAgICAgIGFsdGVyU3RhdGUuaXNSZXNldHRpbmcgPSBmYWxzZTtcclxuICAgICAgICBhbHRlclN0YXRlLmVyck1lc3NhZ2UgPSB0aGlzLmVyck1lc3NhZ2VzLnVuU3VwcG9ydElmcmFtZVVybFxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoYWx0ZXJTdGF0ZSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBpc09yaWdpblNhbWVBc0xvY2F0aW9uKHVybCkge1xyXG4gICAgdmFyIHBhZ2VMb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbjtcclxuICAgIHZhciBVUkxfSE9TVF9QQVRURVJOID0gLyhcXHcrOik/KD86XFwvXFwvKShbXFx3Li1dKyk/KD86OihcXGQrKSk/XFwvPy87XHJcbiAgICB2YXIgdXJsTWF0Y2ggPSBVUkxfSE9TVF9QQVRURVJOLmV4ZWModXJsKSB8fCBbXTtcclxuICAgIHZhciB1cmxwYXJ0cyA9IHtcclxuICAgICAgcHJvdG9jb2w6IHVybE1hdGNoWzFdIHx8ICcnLFxyXG4gICAgICBob3N0OiB1cmxNYXRjaFsyXSB8fCAnJyxcclxuICAgICAgcG9ydDogdXJsTWF0Y2hbM10gfHwgJydcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgZGVmYXVsdFBvcnQgPSAocHJvdG9jb2wpID0+IHtcclxuICAgICAgcmV0dXJuIHsgJ2h0dHA6JzogODAsICdodHRwczonOiA0NDMgfVtwcm90b2NvbF07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcG9ydE9mID0gKGxvY2F0aW9uKSA9PiB7XHJcbiAgICAgIHJldHVybiBsb2NhdGlvbi5wb3J0IHx8IGRlZmF1bHRQb3J0KGxvY2F0aW9uLnByb3RvY29sIHx8IHBhZ2VMb2NhdGlvbi5wcm90b2NvbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICEhKCh1cmxwYXJ0cy5wcm90b2NvbCAmJiAodXJscGFydHMucHJvdG9jb2wgPT0gcGFnZUxvY2F0aW9uLnByb3RvY29sKSkgJiZcclxuICAgICAgKHVybHBhcnRzLmhvc3QgJiYgKHVybHBhcnRzLmhvc3QgPT0gcGFnZUxvY2F0aW9uLmhvc3QpKSAmJlxyXG4gICAgICAodXJscGFydHMuaG9zdCAmJiAocG9ydE9mKHVybHBhcnRzKSA9PSBwb3J0T2YocGFnZUxvY2F0aW9uKSkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZm9ybWF0TWVzc2FnZSA9IChpZDogc3RyaW5nKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogaWQsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXNbaWRdIH0pXHJcbiAgfVxyXG5cclxuICBmZXRjaFVybCA9IGFzeW5jICh1cmwpOiBQcm9taXNlPGFueT4gPT4ge1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyxcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L2pzb24nXHJcbiAgICB9XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwsIHtcclxuICAgICAgbWV0aG9kOiAnZ2V0JyxcclxuICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgIH0pLmNhdGNoKGVyciA9PiB7IH0pO1xyXG4gICAgaWYgKCFyZXN1bHQpIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzdWx0Lmpzb24oKS5jYXRjaChlcnJvciA9PiB7IH0pO1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShqc29uKTtcclxuICB9XHJcblxyXG4gIGlzVXNlZERhdGFTb3VyY2UgPSAocHJvcHM/OiBBbGxXaWRnZXRQcm9wczxJTUNvbmZpZz4pID0+IHtcclxuICAgIGlmICghcHJvcHMpIHtcclxuICAgICAgcHJvcHMgPSB0aGlzLnByb3BzXHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHVzZURhdGFTb3VyY2VzLCB1c2VEYXRhU291cmNlc0VuYWJsZWQgfSA9IHByb3BzO1xyXG4gICAgcmV0dXJuIHVzZURhdGFTb3VyY2VzRW5hYmxlZCAmJiB1c2VEYXRhU291cmNlcyAmJiB1c2VEYXRhU291cmNlcy5sZW5ndGggPiAwXHJcbiAgfVxyXG5cclxuICBvblVybEV4cFJlc29sdmVDaGFuZ2UgPSByZXN1bHQgPT4ge1xyXG4gICAgaWYocmVzdWx0Py5pc1N1Y2Nlc3NmdWwpe1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBjb250ZW50OiByZXN1bHQudmFsdWUsXHJcbiAgICAgICAgcmVzb2x2ZUVycjogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgcmVzb2x2ZUVycjogdHJ1ZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFJlY29yZHNGcm9tUmVwZWF0ZWREYXRhU291cmNlID0gKCk6IHsgW2RhdGFTb3VyY2VJZDogc3RyaW5nXTogRGF0YVJlY29yZCB9ID0+IHtcclxuICAgIGNvbnN0IGRhdGFTb3VyY2VJZCA9IHRoaXMucHJvcHMudXNlRGF0YVNvdXJjZXMgJiYgdGhpcy5wcm9wcy51c2VEYXRhU291cmNlc1swXSAmJiB0aGlzLnByb3BzLnVzZURhdGFTb3VyY2VzWzBdLmRhdGFTb3VyY2VJZDtcclxuXHJcbiAgICBpZiAoZGF0YVNvdXJjZUlkICYmIHRoaXMucHJvcHMucmVwZWF0ZWREYXRhU291cmNlKSB7XHJcbiAgICAgIGlmIChkYXRhU291cmNlSWQgPT09ICh0aGlzLnByb3BzLnJlcGVhdGVkRGF0YVNvdXJjZSBhcyBSZXBlYXRlZERhdGFTb3VyY2UpLmRhdGFTb3VyY2VJZCkge1xyXG4gICAgICAgIGNvbnN0IHJlY29yZCA9ICh0aGlzLnByb3BzLnJlcGVhdGVkRGF0YVNvdXJjZSBhcyBSZXBlYXRlZERhdGFTb3VyY2UpLnJlY29yZCBhcyBEYXRhUmVjb3JkO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgW2RhdGFTb3VyY2VJZF06IHJlY29yZFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgb25SZXNpemUgPSAod2lkdGgsIGhlaWdodCkgPT4ge1xyXG4gICAgaWYodGhpcy5zaXplKXtcclxuICAgICAgY29uc3Qge3dpZHRoOiBvbGRXaWR0aCwgaGVpZ2h0OiBvbGRIZWlnaHR9ID0gdGhpcy5zaXplXHJcbiAgICAgIGlmKChvbGRXaWR0aCA8IDEgfHwgb2xkSGVpZ2h0IDwgMSkgJiYgKHdpZHRoID4gMSAmJiBoZWlnaHQgPiAxKSl7XHJcbiAgICAgICAgaWYodGhpcy5uZWVkUmVsb2FkKXtcclxuICAgICAgICAgIHRoaXMucmVsb2FkKClcclxuICAgICAgICAgIHRoaXMubmVlZFJlbG9hZCA9IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnNpemUgPSB7XHJcbiAgICAgIHdpZHRoLFxyXG4gICAgICBoZWlnaHRcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICByZWxvYWQgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7Y29uZmlnfSA9IHRoaXMucHJvcHNcclxuICAgIGlmKHRoaXMuaWZyKXtcclxuICAgICAgaWYoY29uZmlnLmVtYmVkVHlwZSA9PT0gRW1iZWRUeXBlLkNvZGUpey8vY29kZVxyXG4gICAgICAgIGNvbnN0IHNyY0RvYyA9IHRoaXMuaWZyLnNyY2RvYztcclxuICAgICAgICB0aGlzLmlmci5zcmNkb2MgPSBzcmNEb2M7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIGNvbnN0IHNyYyA9IHRoaXMuaWZyLnNyYztcclxuICAgICAgICB0aGlzLmlmci5zcmMgPSBzcmM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxvYWRDb250ZW50ID0gKCkgPT4ge1xyXG4gICAgY29uc3Qge2NvbmZpZ30gPSB0aGlzLnByb3BzXHJcbiAgICBjb25zdCB7IGNvbnRlbnQgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCB7ZW1iZWRUeXBlfSA9IGNvbmZpZztcclxuICAgIGlmKHRoaXMuaWZyKXtcclxuICAgICAgaWYoZW1iZWRUeXBlID09PSBFbWJlZFR5cGUuQ29kZSl7Ly9jb2RlXHJcbiAgICAgICAgdGhpcy5pZnIuc3JjZG9jID0gY29udGVudDtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgdGhpcy5pZnIuc3JjID0gdGhpcy5wcm9jZXNzVXJsKGNvbnRlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGlzUmVzZXR0aW5nLCBsb2FkRXJyLCBlcnJNZXNzYWdlLCByZXNvbHZlRXJyIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgeyB0aGVtZSwgaWQsIGNvbmZpZyB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHsgZW1iZWRDb2RlLCBlbWJlZFR5cGUsIHN0YXRpY1VybCwgZXhwcmVzc2lvbiB9ID0gY29uZmlnO1xyXG4gICAgY29uc3QgaXNEYXRhU291cmNlVXNlZCA9IHRoaXMucHJvcHMudXNlRGF0YVNvdXJjZXNFbmFibGVkO1xyXG5cclxuICAgIGNvbnN0IHNob3dQbGFjZWhvbGRlciA9IGVtYmVkVHlwZSA9PT0gRW1iZWRUeXBlLkNvZGUgPyAhZW1iZWRDb2RlIDpcclxuICAgICAgKCghc3RhdGljVXJsICYmICFpc0RhdGFTb3VyY2VVc2VkKSB8fCAoaXNEYXRhU291cmNlVXNlZCAmJiAhZXhwcmVzc2lvbikpXHJcbiAgICBpZiAoc2hvd1BsYWNlaG9sZGVyKSB7XHJcbiAgICAgIHJldHVybiA8V2lkZ2V0UGxhY2Vob2xkZXJcclxuICAgICAgICB3aWRnZXRJZD17dGhpcy5wcm9wcy5pZH1cclxuICAgICAgICBpY29uPXtyZXF1aXJlKCcuL2Fzc2V0cy9pY29uLnN2ZycpfVxyXG4gICAgICAgIG1lc3NhZ2U9e3RoaXMuZm9ybWF0TWVzc2FnZSgnZW1iZWRIaW50Jyl9IC8+O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJywgaGVpZ2h0OiAnMTAwJScsIHBvc2l0aW9uOiAncmVsYXRpdmUnIH19IGNsYXNzTmFtZT1cImppbXUtd2lkZ2V0IHdpZGdldC1lbWJlZFwiPlxyXG4gICAgICAgIDxpZnJhbWVcclxuICAgICAgICAgIGNsYXNzTmFtZT17YGlmcmFtZS0ke2lkfWB9XHJcbiAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJyB9fVxyXG4gICAgICAgICAgc2FuZGJveD1cImFsbG93LXNjcmlwdHMgYWxsb3ctc2FtZS1vcmlnaW4gYWxsb3ctZm9ybXMgYWxsb3ctcG9wdXBzIGFsbG93LXByZXNlbnRhdGlvbiBhbGxvdy1wb3B1cHMtdG8tZXNjYXBlLXNhbmRib3ggYWxsb3ctZG93bmxvYWRzXCJcclxuICAgICAgICAgIGFsbG93RnVsbFNjcmVlblxyXG4gICAgICAgICAgb25Mb2FkPXt0aGlzLmlmcmFtZU9uTG9hZH1cclxuICAgICAgICAgIGZyYW1lQm9yZGVyPVwiMFwiXHJcbiAgICAgICAgICByZWY9eyhmKSA9PiB7IHRoaXMuaWZyID0gZjsgfX1cclxuICAgICAgICAvPlxyXG4gICAgICAgIHtpc1Jlc2V0dGluZyAmJiA8ZGl2IGNsYXNzTmFtZT1cImppbXUtc2Vjb25kYXJ5LWxvYWRpbmdcIj48L2Rpdj59XHJcbiAgICAgICAge2xvYWRFcnIgJiZcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFzayB0ZXh0LWNlbnRlclwiXHJcbiAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXHJcbiAgICAgICAgICAgICAgbGVmdDogMCxcclxuICAgICAgICAgICAgICByaWdodDogMCxcclxuICAgICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgICAgYm90dG9tOiAwLFxyXG4gICAgICAgICAgICAgIHBhZGRpbmdUb3A6ICczMCUnLFxyXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUuY29sb3JzLndoaXRlXHJcbiAgICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICB7ZXJyTWVzc2FnZX1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIH1cclxuICAgICAgICB7cmVzb2x2ZUVyciAmJiBpc0RhdGFTb3VyY2VVc2VkICYmXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1hc2sgdGV4dC1jZW50ZXJcIlxyXG4gICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgICAgICAgIGxlZnQ6IDAsXHJcbiAgICAgICAgICAgICAgcmlnaHQ6IDAsXHJcbiAgICAgICAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICAgICAgIGJvdHRvbTogMCxcclxuICAgICAgICAgICAgICBwYWRkaW5nVG9wOiAnMzAlJyxcclxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLmNvbG9ycy53aGl0ZVxyXG4gICAgICAgICAgICB9fT5cclxuICAgICAgICAgICAge2V4cHJlc3Npb24/Lm5hbWV9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICB9XHJcbiAgICAgICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiAnbm9uZScgfX0+XHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGlzRGF0YVNvdXJjZVVzZWQgJiYgZW1iZWRUeXBlID09PSBFbWJlZFR5cGUuVXJsICYmIGV4cHJlc3Npb24gJiZcclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICA8RXhwcmVzc2lvblJlc29sdmVyQ29tcG9uZW50IHVzZURhdGFTb3VyY2VzPXt0aGlzLnByb3BzLnVzZURhdGFTb3VyY2VzfSBleHByZXNzaW9uPXtleHByZXNzaW9ufVxyXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25VcmxFeHBSZXNvbHZlQ2hhbmdlfSB3aWRnZXRJZD17dGhpcy5wcm9wcy5pZH1cclxuICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIH1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8UmVhY3RSZXNpemVEZXRlY3RvciBoYW5kbGVXaWR0aCBoYW5kbGVIZWlnaHQgb25SZXNpemU9e3RoaXMub25SZXNpemV9IC8+XHJcbiAgICAgIDwvZGl2PlxyXG5cclxuXHJcbiAgICApXHJcbiAgfVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQUE7QUFtQkE7QUFBQTtBQXlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFpRkE7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFIQTtBQUlBO0FBQUE7QUFDQTs7QUFBQTtBQUNBOzs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWxWQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUE4RUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFvR0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBRUE7QUFTQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7QUFNQTtBQUtBO0FBOWFBO0FBWUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUErWkE7QUFBQTtBQWhiQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./your-extensions/widgets/embed-download/src/runtime/widget.tsx\n");

/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamltdS1jb3JlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiamltdS1jb3JlXCI/YzY5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfamltdV9jb3JlX187Il0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///jimu-core\n");

/***/ }),

/***/ "jimu-ui":
/*!**************************!*\
  !*** external "jimu-ui" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_ui__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamltdS11aS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImppbXUtdWlcIj8zNTQzIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9qaW11X3VpX187Il0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///jimu-ui\n");

/***/ })

/******/ })});;